import{a as he,b as qt,c as ki}from"./chunk-HTZT4UGI.js";import{a as Ii,b as Ti,c as Di,d as wi}from"./chunk-J6AJW7T2.js";import{a as Si,c as yi,g as Mi}from"./chunk-NDNJYYJX.js";import{a as nt,b as Je}from"./chunk-TF6AOZTO.js";import"./chunk-4T44NYJG.js";import{a as rt}from"./chunk-XUEP42PT.js";import{a as ot}from"./chunk-FPTRVRTR.js";import{a as jt,b as Ht,c as bi,d as Nt,e as $t,f as Qt,g as Ci}from"./chunk-SQUVXOXM.js";import"./chunk-BNUCCXS7.js";import{b as Vt}from"./chunk-EK67O6HC.js";import{a as ri,b as oi,c as ai,d as si,e as pi,f as li,h as ci,j as xi}from"./chunk-PZQC65FW.js";import{a as O,b as ni,c as vi}from"./chunk-F4STTNID.js";import{A as mi,B as hi,Q as Bt,S as H,T as Lt,U as ui,V as At,W as fi,Z as gi,a as it,ba as _i,d as Pt,e as Ze,g as zt,j as se,k as pe,l as le,n as U,o as G,q as ce,r as de,s as me,x as di}from"./chunk-EVOHVUKJ.js";import{a as ei,b as Ft}from"./chunk-F5E23MD5.js";import{a as Rt}from"./chunk-BOSFDDH7.js";import{a as ii}from"./chunk-ZWL73D3D.js";import{d as Xe,f as ti}from"./chunk-PQ4C2WEQ.js";import{B as $e,I as Qe,L as qe,_ as Ue,da as Ge,ga as Et,ha as Ke,ka as ae,na as xt,o as oe,p as et,q as Ot,qa as We,r as Ne,ra as Ye}from"./chunk-YQJCNX7A.js";import{$b as ut,Ab as f,Ac as _t,Bb as mt,Bc as k,Ca as Re,Cb as g,Dc as je,Eb as j,Fb as Be,Gb as Le,Ha as Z,Hb as v,Ib as B,Jb as Dt,Ka as Fe,Kb as T,La as Tt,Lb as D,Ma as J,Mb as p,Na as lt,Nb as l,Nc as vt,Ob as y,P as De,Rb as q,Rc as tt,Sb as F,Sc as He,Tc as R,Xb as w,Y,Z as we,Zb as c,_ as $,_b as ht,a as at,ac as Ae,b as st,bc as L,cc as wt,da as St,dc as E,ea as yt,ec as P,fa as Mt,fb as s,g as Me,gb as h,ha as ke,ib as Q,ic as ee,jc as d,ka as u,kc as z,l as pt,la as Oe,lc as b,ma as Ee,mc as X,nc as Ve,oa as x,pa as It,pb as ze,qa as V,r as Ie,rb as ct,rc as kt,sc as ie,tc as ne,uc as ft,vb as dt,vc as C,w as Te,wc as re,xa as Pe,xb as te,xc as gt,ya as M,za as I,zc as S}from"./chunk-MTQVXK5S.js";var ue={entity:void 0,collection:"rides",selectId:i=>i.rideId};var Ut=Lt({providedIn:"root"},_i(ue),At((i,n=u(xi))=>({async getRide(o){let t=await n.loadRide(o);H(i,gi(t,ue))}})));var Wi=["*"];function Yi(i,n){i&1&&ut(0)}var fe=(()=>{let n=class n{constructor(t){this._elementRef=t}focus(){this._elementRef.nativeElement.focus()}};n.\u0275fac=function(e){return new(e||n)(h(J))},n.\u0275dir=V({type:n,selectors:[["","cdkStepHeader",""]],hostAttrs:["role","tab"],standalone:!0});let i=n;return i})(),ge=(()=>{let n=class n{constructor(t){this.template=t}};n.\u0275fac=function(e){return new(e||n)(h(Q))},n.\u0275dir=V({type:n,selectors:[["","cdkStepLabel",""]],standalone:!0});let i=n;return i})(),Zi=0;var A={NUMBER:"number",EDIT:"edit",DONE:"done",ERROR:"error"},_e=new ke("STEPPER_GLOBAL_OPTIONS"),Gt=(()=>{let n=class n{get completed(){return this._completedOverride==null?this._getDefaultCompleted():this._completedOverride}set completed(t){this._completedOverride=t}_getDefaultCompleted(){return this.stepControl?this.stepControl.valid&&this.interacted:this.interacted}get hasError(){return this._customError==null?this._getDefaultError():this._customError}set hasError(t){this._customError=t}_getDefaultError(){return this.stepControl&&this.stepControl.invalid&&this.interacted}constructor(t,e){this._stepper=t,this.interacted=!1,this.interactedStream=new Z,this.editable=!0,this.optional=!1,this._completedOverride=null,this._customError=null,this._stepperOptions=e||{},this._displayDefaultIndicatorType=this._stepperOptions.displayDefaultIndicatorType!==!1}select(){this._stepper.selected=this}reset(){this.interacted=!1,this._completedOverride!=null&&(this._completedOverride=!1),this._customError!=null&&(this._customError=!1),this.stepControl&&this.stepControl.reset()}ngOnChanges(){this._stepper._stateChanged()}_markAsInteracted(){this.interacted||(this.interacted=!0,this.interactedStream.emit(this))}_showError(){return this._stepperOptions.showError??this._customError!=null}};n.\u0275fac=function(e){return new(e||n)(h(St(()=>Kt)),h(_e,8))},n.\u0275cmp=x({type:n,selectors:[["cdk-step"]],contentQueries:function(e,r,a){if(e&1&&L(a,ge,5),e&2){let m;E(m=P())&&(r.stepLabel=m.first)}},viewQuery:function(e,r){if(e&1&&wt(Q,7),e&2){let a;E(a=P())&&(r.content=a.first)}},inputs:{stepControl:"stepControl",label:"label",errorMessage:"errorMessage",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],state:"state",editable:[2,"editable","editable",tt],optional:[2,"optional","optional",tt],completed:[2,"completed","completed",tt],hasError:[2,"hasError","hasError",tt]},outputs:{interactedStream:"interacted"},exportAs:["cdkStep"],standalone:!0,features:[te,Pe,C],ngContentSelectors:Wi,decls:1,vars:0,template:function(e,r){e&1&&(ht(),f(0,Yi,1,0,"ng-template"))},encapsulation:2,changeDetection:0});let i=n;return i})(),Kt=(()=>{let n=class n{get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this.steps&&this._steps?(this._isValidIndex(t),this.selected?._markAsInteracted(),this._selectedIndex!==t&&!this._anyControlsInvalidOrPending(t)&&(t>=this._selectedIndex||this.steps.toArray()[t].editable)&&this._updateSelectedItemIndex(t)):this._selectedIndex=t}get selected(){return this.steps?this.steps.toArray()[this.selectedIndex]:void 0}set selected(t){this.selectedIndex=t&&this.steps?this.steps.toArray().indexOf(t):-1}get orientation(){return this._orientation}set orientation(t){this._orientation=t,this._keyManager&&this._keyManager.withVerticalOrientation(t==="vertical")}constructor(t,e,r){this._dir=t,this._changeDetectorRef=e,this._elementRef=r,this._destroyed=new pt,this.steps=new lt,this._sortedHeaders=new lt,this.linear=!1,this._selectedIndex=0,this.selectionChange=new Z,this.selectedIndexChange=new Z,this._orientation="horizontal",this._groupId=Zi++}ngAfterContentInit(){this._steps.changes.pipe(Y(this._steps),$(this._destroyed)).subscribe(t=>{this.steps.reset(t.filter(e=>e._stepper===this)),this.steps.notifyOnChanges()})}ngAfterViewInit(){this._stepHeader.changes.pipe(Y(this._stepHeader),$(this._destroyed)).subscribe(t=>{this._sortedHeaders.reset(t.toArray().sort((e,r)=>e._elementRef.nativeElement.compareDocumentPosition(r._elementRef.nativeElement)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)),this._sortedHeaders.notifyOnChanges()}),this._keyManager=new Ue(this._sortedHeaders).withWrap().withHomeAndEnd().withVerticalOrientation(this._orientation==="vertical"),(this._dir?this._dir.change:Ie()).pipe(Y(this._layoutDirection()),$(this._destroyed)).subscribe(t=>this._keyManager.withHorizontalOrientation(t)),this._keyManager.updateActiveItem(this._selectedIndex),this.steps.changes.subscribe(()=>{this.selected||(this._selectedIndex=Math.max(this._selectedIndex-1,0))}),this._isValidIndex(this._selectedIndex)||(this._selectedIndex=0)}ngOnDestroy(){this._keyManager?.destroy(),this.steps.destroy(),this._sortedHeaders.destroy(),this._destroyed.next(),this._destroyed.complete()}next(){this.selectedIndex=Math.min(this._selectedIndex+1,this.steps.length-1)}previous(){this.selectedIndex=Math.max(this._selectedIndex-1,0)}reset(){this._updateSelectedItemIndex(0),this.steps.forEach(t=>t.reset()),this._stateChanged()}_getStepLabelId(t){return`cdk-step-label-${this._groupId}-${t}`}_getStepContentId(t){return`cdk-step-content-${this._groupId}-${t}`}_stateChanged(){this._changeDetectorRef.markForCheck()}_getAnimationDirection(t){let e=t-this._selectedIndex;return e<0?this._layoutDirection()==="rtl"?"next":"previous":e>0?this._layoutDirection()==="rtl"?"previous":"next":"current"}_getIndicatorType(t,e=A.NUMBER){let r=this.steps.toArray()[t],a=this._isCurrentStep(t);return r._displayDefaultIndicatorType?this._getDefaultIndicatorLogic(r,a):this._getGuidelineLogic(r,a,e)}_getDefaultIndicatorLogic(t,e){return t._showError()&&t.hasError&&!e?A.ERROR:!t.completed||e?A.NUMBER:t.editable?A.EDIT:A.DONE}_getGuidelineLogic(t,e,r=A.NUMBER){return t._showError()&&t.hasError&&!e?A.ERROR:t.completed&&!e?A.DONE:t.completed&&e?r:t.editable&&e?A.EDIT:r}_isCurrentStep(t){return this._selectedIndex===t}_getFocusIndex(){return this._keyManager?this._keyManager.activeItemIndex:this._selectedIndex}_updateSelectedItemIndex(t){let e=this.steps.toArray();this.selectionChange.emit({selectedIndex:t,previouslySelectedIndex:this._selectedIndex,selectedStep:e[t],previouslySelectedStep:e[this._selectedIndex]}),this._containsFocus()?this._keyManager.setActiveItem(t):this._keyManager.updateActiveItem(t),this._selectedIndex=t,this.selectedIndexChange.emit(this._selectedIndex),this._stateChanged()}_onKeydown(t){let e=qe(t),r=t.keyCode,a=this._keyManager;a.activeItemIndex!=null&&!e&&(r===32||r===13)?(this.selectedIndex=a.activeItemIndex,t.preventDefault()):a.setFocusOrigin("keyboard").onKeydown(t)}_anyControlsInvalidOrPending(t){return this.linear&&t>=0?this.steps.toArray().slice(0,t).some(e=>{let r=e.stepControl;return(r?r.invalid||r.pending||!e.interacted:!e.completed)&&!e.optional&&!e._completedOverride}):!1}_layoutDirection(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}_containsFocus(){let t=this._elementRef.nativeElement,e=Qe();return t===e||t.contains(e)}_isValidIndex(t){return t>-1&&(!this.steps||t<this.steps.length)}};n.\u0275fac=function(e){return new(e||n)(h(Et,8),h(vt),h(J))},n.\u0275dir=V({type:n,selectors:[["","cdkStepper",""]],contentQueries:function(e,r,a){if(e&1&&(L(a,Gt,5),L(a,fe,5)),e&2){let m;E(m=P())&&(r._steps=m),E(m=P())&&(r._stepHeader=m)}},inputs:{linear:[2,"linear","linear",tt],selectedIndex:[2,"selectedIndex","selectedIndex",He],selected:"selected",orientation:"orientation"},outputs:{selectionChange:"selectionChange",selectedIndexChange:"selectedIndexChange"},exportAs:["cdkStepper"],standalone:!0,features:[te]});let i=n;return i})();var Oi=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=It({type:n}),n.\u0275inj=Mt({imports:[Ke]});let i=n;return i})();function Ji(i,n){if(i&1&&q(0,2),i&2){let o=c();g("ngTemplateOutlet",o.iconOverrides[o.state])("ngTemplateOutletContext",o._getIconContext())}}function Xi(i,n){if(i&1&&(p(0,"span",7),d(1),l()),i&2){let o=c(2);s(),z(o._getDefaultTextForState(o.state))}}function tn(i,n){if(i&1&&(p(0,"span",8),d(1),l()),i&2){let o=c(3);s(),z(o._intl.completedLabel)}}function en(i,n){if(i&1&&(p(0,"span",8),d(1),l()),i&2){let o=c(3);s(),z(o._intl.editableLabel)}}function nn(i,n){if(i&1&&(f(0,tn,2,1,"span",8)(1,en,2,1,"span",8),p(2,"mat-icon",7),d(3),l()),i&2){let o=c(2);v(o.state==="done"?0:o.state==="edit"?1:-1),s(3),z(o._getDefaultTextForState(o.state))}}function rn(i,n){if(i&1&&f(0,Xi,2,1,"span",7)(1,nn,4,2,"mat-icon",7),i&2){let o,t=c();v((o=t.state)==="number"?0:1)}}function on(i,n){i&1&&(p(0,"div",4),q(1,9),l()),i&2&&(s(),g("ngTemplateOutlet",n.template))}function an(i,n){if(i&1&&(p(0,"div",4),d(1),l()),i&2){let o=c();s(),z(o.label)}}function sn(i,n){if(i&1&&(p(0,"div",5),d(1),l()),i&2){let o=c();s(),z(o._intl.optionalLabel)}}function pn(i,n){if(i&1&&(p(0,"div",6),d(1),l()),i&2){let o=c();s(),z(o.errorMessage)}}var Pi=["*"];function ln(i,n){}function cn(i,n){if(i&1&&(ut(0),f(1,ln,0,0,"ng-template",0)),i&2){let o=c();s(),g("cdkPortalOutlet",o._portal)}}var Ri=(i,n)=>({step:i,i:n}),Fi=i=>({animationDuration:i}),zi=(i,n)=>({value:i,params:n});function dn(i,n){i&1&&ut(0)}function mn(i,n){i&1&&y(0,"div",6)}function hn(i,n){if(i&1&&(q(0,5),f(1,mn,1,0,"div",6)),i&2){let o=n.$implicit,t=n.$index,e=n.$count;c(2);let r=ee(4);g("ngTemplateOutlet",r)("ngTemplateOutletContext",gt(3,Ri,o,t)),s(),v(t!==e-1?1:-1)}}function un(i,n){if(i&1){let o=F();p(0,"div",7),w("@horizontalStepTransition.done",function(e){M(o);let r=c(2);return I(r._animationDone.next(e))}),q(1,8),l()}if(i&2){let o=n.$implicit,t=n.$index,e=c(2);j("mat-horizontal-stepper-content-inactive",e.selectedIndex!==t),g("@horizontalStepTransition",gt(8,zi,e._getAnimationDirection(t),re(6,Fi,e._getAnimationDuration())))("id",e._getStepContentId(t)),mt("aria-labelledby",e._getStepLabelId(t)),s(),g("ngTemplateOutlet",o.content)}}function fn(i,n){if(i&1&&(p(0,"div",1)(1,"div",2),T(2,hn,2,6,null,null,Dt),l(),p(4,"div",3),T(5,un,2,11,"div",4,Dt),l()()),i&2){let o=c();s(2),D(o.steps),s(3),D(o.steps)}}function gn(i,n){if(i&1){let o=F();p(0,"div",9),q(1,5),p(2,"div",10)(3,"div",11),w("@verticalStepTransition.done",function(e){M(o);let r=c(2);return I(r._animationDone.next(e))}),p(4,"div",12),q(5,8),l()()()()}if(i&2){let o=n.$implicit,t=n.$index,e=n.$count,r=c(2),a=ee(4);s(),g("ngTemplateOutlet",a)("ngTemplateOutletContext",gt(10,Ri,o,t)),s(),j("mat-stepper-vertical-line",t!==e-1),s(),j("mat-vertical-stepper-content-inactive",r.selectedIndex!==t),g("@verticalStepTransition",gt(15,zi,r._getAnimationDirection(t),re(13,Fi,r._getAnimationDuration())))("id",r._getStepContentId(t)),mt("aria-labelledby",r._getStepLabelId(t)),s(2),g("ngTemplateOutlet",o.content)}}function _n(i,n){if(i&1&&T(0,gn,6,18,"div",9,Dt),i&2){let o=c();D(o.steps)}}function vn(i,n){if(i&1){let o=F();p(0,"mat-step-header",13),w("click",function(){let e=M(o).step;return I(e.select())})("keydown",function(e){M(o);let r=c();return I(r._onKeydown(e))}),l()}if(i&2){let o=n.step,t=n.i,e=c();j("mat-horizontal-stepper-header",e.orientation==="horizontal")("mat-vertical-stepper-header",e.orientation==="vertical"),g("tabIndex",e._getFocusIndex()===t?0:-1)("id",e._getStepLabelId(t))("index",t)("state",e._getIndicatorType(t,o.state))("label",o.stepLabel||o.label)("selected",e.selectedIndex===t)("active",e._stepIsNavigable(t,o))("optional",o.optional)("errorMessage",o.errorMessage)("iconOverrides",e._iconOverrides)("disableRipple",e.disableRipple||!e._stepIsNavigable(t,o))("color",o.color||e.color),mt("aria-posinset",t+1)("aria-setsize",e.steps.length)("aria-controls",e._getStepContentId(t))("aria-selected",e.selectedIndex==t)("aria-label",o.ariaLabel||null)("aria-labelledby",!o.ariaLabel&&o.ariaLabelledby?o.ariaLabelledby:null)("aria-disabled",e._stepIsNavigable(t,o)?null:!0)}}var bt=(()=>{let n=class n extends ge{};n.\u0275fac=(()=>{let t;return function(r){return(t||(t=Re(n)))(r||n)}})(),n.\u0275dir=V({type:n,selectors:[["","matStepLabel",""]],standalone:!0,features:[dt]});let i=n;return i})(),Wt=(()=>{let n=class n{constructor(){this.changes=new pt,this.optionalLabel="Optional",this.completedLabel="Completed",this.editableLabel="Editable"}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();function xn(i){return i||new Wt}var bn={provide:Wt,deps:[[new Oe,new Ee,Wt]],useFactory:xn},ve=(()=>{let n=class n extends fe{constructor(t,e,r,a){super(r),this._intl=t,this._focusMonitor=e,this._intlSubscription=t.changes.subscribe(()=>a.markForCheck())}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._intlSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._elementRef)}focus(t,e){t?this._focusMonitor.focusVia(this._elementRef,t,e):this._elementRef.nativeElement.focus(e)}_stringLabel(){return this.label instanceof bt?null:this.label}_templateLabel(){return this.label instanceof bt?this.label:null}_getHostElement(){return this._elementRef.nativeElement}_getIconContext(){return{index:this.index,active:this.active,optional:this.optional}}_getDefaultTextForState(t){return t=="number"?`${this.index+1}`:t=="edit"?"create":t=="error"?"warning":t}};n.\u0275fac=function(e){return new(e||n)(h(Wt),h(Ge),h(J),h(vt))},n.\u0275cmp=x({type:n,selectors:[["mat-step-header"]],hostAttrs:["role","tab",1,"mat-step-header"],hostVars:2,hostBindings:function(e,r){e&2&&Be("mat-"+(r.color||"primary"))},inputs:{state:"state",label:"label",errorMessage:"errorMessage",iconOverrides:"iconOverrides",index:"index",selected:"selected",active:"active",optional:"optional",disableRipple:"disableRipple",color:"color"},standalone:!0,features:[dt,C],decls:10,vars:17,consts:[["matRipple","",1,"mat-step-header-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-step-icon-content"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-step-label"],[1,"mat-step-text-label"],[1,"mat-step-optional"],[1,"mat-step-sub-label-error"],["aria-hidden","true"],[1,"cdk-visually-hidden"],[3,"ngTemplateOutlet"]],template:function(e,r){if(e&1&&(y(0,"div",0),p(1,"div")(2,"div",1),f(3,Ji,1,2,"ng-container",2)(4,rn,2,1),l()(),p(5,"div",3),f(6,on,2,1,"div",4)(7,an,2,1,"div",4)(8,sn,2,1,"div",5)(9,pn,2,1,"div",6),l()),e&2){let a;g("matRippleTrigger",r._getHostElement())("matRippleDisabled",r.disableRipple),s(),Le("mat-step-icon-state-",r.state," mat-step-icon"),j("mat-step-icon-selected",r.selected),s(2),v(r.iconOverrides&&r.iconOverrides[r.state]?3:4),s(2),j("mat-step-label-active",r.active)("mat-step-label-selected",r.selected)("mat-step-label-error",r.state=="error"),s(),v((a=r._templateLabel())?6:r._stringLabel()?7:-1,a),s(2),v(r.optional&&r.state!="error"?8:-1),s(),v(r.state==="error"?9:-1)}},dependencies:[We,oe,nt],styles:['.mat-step-header{overflow:hidden;outline:none;cursor:pointer;position:relative;box-sizing:content-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-step-header:focus .mat-focus-indicator::before{content:""}.mat-step-header:hover[aria-disabled=true]{cursor:default}.mat-step-header:hover:not([aria-disabled]),.mat-step-header:hover[aria-disabled=false]{background-color:var(--mat-stepper-header-hover-state-layer-color);border-radius:var(--mat-stepper-header-hover-state-layer-shape, var(--mat-app-corner-medium))}.mat-step-header.cdk-keyboard-focused,.mat-step-header.cdk-program-focused{background-color:var(--mat-stepper-header-focus-state-layer-color);border-radius:var(--mat-stepper-header-focus-state-layer-shape, var(--mat-app-corner-medium))}@media(hover: none){.mat-step-header:hover{background:none}}.cdk-high-contrast-active .mat-step-header{outline:solid 1px}.cdk-high-contrast-active .mat-step-header[aria-selected=true] .mat-step-label{text-decoration:underline}.cdk-high-contrast-active .mat-step-header[aria-disabled=true]{outline-color:GrayText}.cdk-high-contrast-active .mat-step-header[aria-disabled=true] .mat-step-label,.cdk-high-contrast-active .mat-step-header[aria-disabled=true] .mat-step-icon,.cdk-high-contrast-active .mat-step-header[aria-disabled=true] .mat-step-optional{color:GrayText}.mat-step-optional{font-size:12px;color:var(--mat-stepper-header-optional-label-text-color, var(--mat-app-on-surface-variant))}.mat-step-sub-label-error{font-size:12px;font-weight:normal}.mat-step-icon{border-radius:50%;height:24px;width:24px;flex-shrink:0;position:relative;color:var(--mat-stepper-header-icon-foreground-color, var(--mat-app-surface));background-color:var(--mat-stepper-header-icon-background-color, var(--mat-app-on-surface-variant))}.mat-step-icon-content{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:flex}.mat-step-icon .mat-icon{font-size:16px;height:16px;width:16px}.mat-step-icon-state-error{background-color:var(--mat-stepper-header-error-state-icon-background-color);color:var(--mat-stepper-header-error-state-icon-foreground-color, var(--mat-app-error))}.mat-step-icon-state-error .mat-icon{font-size:24px;height:24px;width:24px}.mat-step-label{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:50px;vertical-align:middle;font-family:var(--mat-stepper-header-label-text-font, var(--mat-app-title-small-font));font-size:var(--mat-stepper-header-label-text-size, var(--mat-app-title-small-size));font-weight:var(--mat-stepper-header-label-text-weight, var(--mat-app-title-small-weight));color:var(--mat-stepper-header-label-text-color, var(--mat-app-on-surface-variant))}.mat-step-label.mat-step-label-active{color:var(--mat-stepper-header-selected-state-label-text-color, var(--mat-app-on-surface-variant))}.mat-step-label.mat-step-label-error{color:var(--mat-stepper-header-error-state-label-text-color, var(--mat-app-error));font-size:var(--mat-stepper-header-error-state-label-text-size, var(--mat-app-title-small-size))}.mat-step-label.mat-step-label-selected{font-size:var(--mat-stepper-header-selected-state-label-text-size, var(--mat-app-title-small-size));font-weight:var(--mat-stepper-header-selected-state-label-text-weight, var(--mat-app-title-small-weight))}.mat-step-text-label{text-overflow:ellipsis;overflow:hidden}.mat-step-header .mat-step-header-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-step-icon-selected{background-color:var(--mat-stepper-header-selected-state-icon-background-color, var(--mat-app-primary));color:var(--mat-stepper-header-selected-state-icon-foreground-color, var(--mat-app-on-primary))}.mat-step-icon-state-done{background-color:var(--mat-stepper-header-done-state-icon-background-color);color:var(--mat-stepper-header-done-state-icon-foreground-color)}.mat-step-icon-state-edit{background-color:var(--mat-stepper-header-edit-state-icon-background-color, var(--mat-app-primary));color:var(--mat-stepper-header-edit-state-icon-foreground-color, var(--mat-app-on-primary))}'],encapsulation:2,changeDetection:0});let i=n;return i})(),Bi="500ms",Li="225ms",Ei={horizontalStepTransition:se("horizontalStepTransition",[G("previous",U({transform:"translate3d(-100%, 0, 0)",visibility:"hidden"})),G("current",U({transform:"none",visibility:"inherit"})),G("next",U({transform:"translate3d(100%, 0, 0)",visibility:"hidden"})),ce("* => *",le([pe("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)"),me("@*",de(),{optional:!0})]),{params:{animationDuration:Bi}})]),verticalStepTransition:se("verticalStepTransition",[G("previous",U({height:"0px",visibility:"hidden"})),G("next",U({height:"0px",visibility:"hidden"})),G("current",U({height:"*",visibility:"inherit"})),ce("* <=> current",le([pe("{{animationDuration}} cubic-bezier(0.4, 0.0, 0.2, 1)"),me("@*",de(),{optional:!0})]),{params:{animationDuration:Li}})])},Cn=(()=>{let n=class n{constructor(t){this.templateRef=t}};n.\u0275fac=function(e){return new(e||n)(h(Q))},n.\u0275dir=V({type:n,selectors:[["ng-template","matStepperIcon",""]],inputs:{name:[0,"matStepperIcon","name"]},standalone:!0});let i=n;return i})(),Sn=(()=>{let n=class n{constructor(t){this._template=t}};n.\u0275fac=function(e){return new(e||n)(h(Q))},n.\u0275dir=V({type:n,selectors:[["ng-template","matStepContent",""]],standalone:!0});let i=n;return i})(),xe=(()=>{let n=class n extends Gt{constructor(t,e,r,a){super(t,a),this._errorStateMatcher=e,this._viewContainerRef=r,this._isSelected=Me.EMPTY,this.stepLabel=void 0}ngAfterContentInit(){this._isSelected=this._stepper.steps.changes.pipe(we(()=>this._stepper.selectionChange.pipe(Te(t=>t.selectedStep===this),Y(this._stepper.selected===this)))).subscribe(t=>{t&&this._lazyContent&&!this._portal&&(this._portal=new di(this._lazyContent._template,this._viewContainerRef))})}ngOnDestroy(){this._isSelected.unsubscribe()}isErrorState(t,e){let r=this._errorStateMatcher.isErrorState(t,e),a=!!(t&&t.invalid&&this.interacted);return r||a}};n.\u0275fac=function(e){return new(e||n)(h(St(()=>Yt)),h(xt,4),h(ze),h(_e,8))},n.\u0275cmp=x({type:n,selectors:[["mat-step"]],contentQueries:function(e,r,a){if(e&1&&(L(a,bt,5),L(a,Sn,5)),e&2){let m;E(m=P())&&(r.stepLabel=m.first),E(m=P())&&(r._lazyContent=m.first)}},hostAttrs:["hidden",""],inputs:{color:"color"},exportAs:["matStep"],standalone:!0,features:[ft([{provide:xt,useExisting:n},{provide:Gt,useExisting:n}]),dt,C],ngContentSelectors:Pi,decls:1,vars:0,consts:[[3,"cdkPortalOutlet"]],template:function(e,r){e&1&&(ht(),f(0,cn,2,1,"ng-template"))},dependencies:[mi],encapsulation:2,changeDetection:0});let i=n;return i})(),Yt=(()=>{let n=class n extends Kt{get animationDuration(){return this._animationDuration}set animationDuration(t){this._animationDuration=/^\d+$/.test(t)?t+"ms":t}constructor(t,e,r){super(t,e,r),this._stepHeader=void 0,this._steps=void 0,this.steps=new lt,this.animationDone=new Z,this.labelPosition="end",this.headerPosition="top",this._iconOverrides={},this._animationDone=new pt,this._animationDuration="",this._isServer=!u($e).isBrowser;let a=r.nativeElement.nodeName.toLowerCase();this.orientation=a==="mat-vertical-stepper"?"vertical":"horizontal"}ngAfterContentInit(){super.ngAfterContentInit(),this._icons.forEach(({name:t,templateRef:e})=>this._iconOverrides[t]=e),this.steps.changes.pipe($(this._destroyed)).subscribe(()=>{this._stateChanged()}),this._animationDone.pipe(De((t,e)=>t.fromState===e.fromState&&t.toState===e.toState),$(this._destroyed)).subscribe(t=>{t.toState==="current"&&this.animationDone.emit()})}_stepIsNavigable(t,e){return e.completed||this.selectedIndex===t||!this.linear}_getAnimationDuration(){return this.animationDuration?this.animationDuration:this.orientation==="horizontal"?Bi:Li}};n.\u0275fac=function(e){return new(e||n)(h(Et,8),h(vt),h(J))},n.\u0275cmp=x({type:n,selectors:[["mat-stepper"],["mat-vertical-stepper"],["mat-horizontal-stepper"],["","matStepper",""]],contentQueries:function(e,r,a){if(e&1&&(L(a,xe,5),L(a,Cn,5)),e&2){let m;E(m=P())&&(r._steps=m),E(m=P())&&(r._icons=m)}},viewQuery:function(e,r){if(e&1&&wt(ve,5),e&2){let a;E(a=P())&&(r._stepHeader=a)}},hostAttrs:["role","tablist"],hostVars:11,hostBindings:function(e,r){e&2&&(mt("aria-orientation",r.orientation),j("mat-stepper-horizontal",r.orientation==="horizontal")("mat-stepper-vertical",r.orientation==="vertical")("mat-stepper-label-position-end",r.orientation==="horizontal"&&r.labelPosition=="end")("mat-stepper-label-position-bottom",r.orientation==="horizontal"&&r.labelPosition=="bottom")("mat-stepper-header-position-bottom",r.headerPosition==="bottom"))},inputs:{disableRipple:"disableRipple",color:"color",labelPosition:"labelPosition",headerPosition:"headerPosition",animationDuration:"animationDuration"},outputs:{animationDone:"animationDone"},exportAs:["matStepper","matVerticalStepper","matHorizontalStepper"],standalone:!0,features:[ft([{provide:Kt,useExisting:n}]),dt,C],ngContentSelectors:Pi,decls:5,vars:2,consts:[["stepTemplate",""],[1,"mat-horizontal-stepper-wrapper"],[1,"mat-horizontal-stepper-header-container"],[1,"mat-horizontal-content-container"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id","mat-horizontal-stepper-content-inactive"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-stepper-horizontal-line"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id"],[3,"ngTemplateOutlet"],[1,"mat-step"],[1,"mat-vertical-content-container"],["role","tabpanel",1,"mat-vertical-stepper-content",3,"id"],[1,"mat-vertical-content"],[3,"click","keydown","tabIndex","id","index","state","label","selected","active","optional","errorMessage","iconOverrides","disableRipple","color"]],template:function(e,r){if(e&1&&(ht(),f(0,dn,1,0)(1,fn,7,0,"div",1)(2,_n,2,0)(3,vn,1,23,"ng-template",null,0,je)),e&2){let a;v(r._isServer?0:-1),s(),v((a=r.orientation)==="horizontal"?1:a==="vertical"?2:-1)}},dependencies:[oe,ve],styles:['.mat-stepper-vertical,.mat-stepper-horizontal{display:block;font-family:var(--mat-stepper-container-text-font, var(--mat-app-body-medium-font));background:var(--mat-stepper-container-color, var(--mat-app-surface))}.mat-horizontal-stepper-header-container{white-space:nowrap;display:flex;align-items:center}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header-container{align-items:flex-start}.mat-stepper-header-position-bottom .mat-horizontal-stepper-header-container{order:1}.mat-stepper-horizontal-line{border-top-width:1px;border-top-style:solid;flex:auto;height:0;margin:0 -16px;min-width:32px;border-top-color:var(--mat-stepper-line-color, var(--mat-app-outline))}.mat-stepper-label-position-bottom .mat-stepper-horizontal-line{margin:0;min-width:0;position:relative;top:calc(calc((var(--mat-stepper-header-height) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{border-top-width:1px;border-top-style:solid;content:"";display:inline-block;height:0;position:absolute;width:calc(50% - 20px)}.mat-horizontal-stepper-header{display:flex;height:72px;overflow:hidden;align-items:center;padding:0 24px;height:var(--mat-stepper-header-height)}.mat-horizontal-stepper-header .mat-step-icon{margin-right:8px;flex:none}[dir=rtl] .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:8px}.mat-horizontal-stepper-header::before,.mat-horizontal-stepper-header::after{border-top-color:var(--mat-stepper-line-color, var(--mat-app-outline))}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{padding:calc((var(--mat-stepper-header-height) - 24px) / 2) 24px}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::after{top:calc(calc((var(--mat-stepper-header-height) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{box-sizing:border-box;flex-direction:column;height:auto}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{right:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before{left:0}[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:last-child::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:first-child::after{display:none}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-label{padding:16px 0 0 0;text-align:center;width:100%}.mat-vertical-stepper-header{display:flex;align-items:center;height:24px;padding:calc((var(--mat-stepper-header-height) - 24px) / 2) 24px}.mat-vertical-stepper-header .mat-step-icon{margin-right:12px}[dir=rtl] .mat-vertical-stepper-header .mat-step-icon{margin-right:0;margin-left:12px}.mat-horizontal-stepper-wrapper{display:flex;flex-direction:column}.mat-horizontal-stepper-content{outline:0}.mat-horizontal-stepper-content.mat-horizontal-stepper-content-inactive{height:0;overflow:hidden}.mat-horizontal-stepper-content:not(.mat-horizontal-stepper-content-inactive){visibility:inherit !important}.mat-horizontal-content-container{overflow:hidden;padding:0 24px 24px 24px}.cdk-high-contrast-active .mat-horizontal-content-container{outline:solid 1px}.mat-stepper-header-position-bottom .mat-horizontal-content-container{padding:24px 24px 0 24px}.mat-vertical-content-container{margin-left:36px;border:0;position:relative}.cdk-high-contrast-active .mat-vertical-content-container{outline:solid 1px}[dir=rtl] .mat-vertical-content-container{margin-left:0;margin-right:36px}.mat-stepper-vertical-line::before{content:"";position:absolute;left:0;border-left-width:1px;border-left-style:solid;border-left-color:var(--mat-stepper-line-color, var(--mat-app-outline));top:calc(8px - calc((var(--mat-stepper-header-height) - 24px) / 2));bottom:calc(8px - calc((var(--mat-stepper-header-height) - 24px) / 2))}[dir=rtl] .mat-stepper-vertical-line::before{left:auto;right:0}.mat-vertical-stepper-content{overflow:hidden;outline:0}.mat-vertical-stepper-content:not(.mat-vertical-stepper-content-inactive){visibility:inherit !important}.mat-vertical-content{padding:0 24px 24px 24px}.mat-step:last-child .mat-vertical-content-container{border:none}'],encapsulation:2,data:{animation:[Ei.horizontalStepTransition,Ei.verticalStepTransition]},changeDetection:0});let i=n;return i})();var Ai=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=It({type:n}),n.\u0275inj=Mt({providers:[bn,xt],imports:[ae,Ne,hi,Oi,Je,Ye,Yt,ve,ae]});let i=n;return i})();function wn(i,n){i&1&&(p(0,"div",5),y(1,"app-spinner",7),l()),i&2&&(s(),g("loadText","Loading the trip info..."))}function kn(i,n){if(i&1&&(p(0,"mat-icon"),d(1,"person_pin_circle"),l(),d(2),S(3,"date")),i&2){let o=c(2).$implicit;s(2),b(" ",k(3,1,o.departure,"MMMM d, HH:mm")," ")}}function On(i,n){if(i&1&&(p(0,"mat-icon"),d(1,"location_on"),l(),d(2),S(3,"date")),i&2){let o=c(2).$implicit;s(2),b(" ",k(3,1,o.arrival,"MMMM d, HH:mm")," ")}}function En(i,n){if(i&1&&(d(0),S(1,"date")),i&2){let o=c(2).$implicit;b(" ",k(1,1,o.departure,"MMMM d, HH:mm")," ")}}function Pn(i,n){if(i&1&&(d(0),S(1,"date")),i&2){let o=c(2).$implicit;b(" ",k(1,1,o.arrival,"MMMM d, HH:mm")," ")}}function Rn(i,n){if(i&1&&d(0),i&2){let o=c(2).$implicit;b(" ",o.dwellTime," min ")}}function Fn(i,n){if(i&1&&(p(0,"div",11),d(1),y(2,"span",2),p(3,"span",12),f(4,kn,4,4)(5,On,4,4)(6,En,2,4)(7,Pn,2,4)(8,Rn,1,1),l()()),i&2){let o=c(),t=o.$implicit,e=o.$index,r=o.$count,a=ne(0),m=ne(1);s(),b(" ",t.station.city," "),s(3),v(a?4:m?5:e===0?6:e===r-1?7:8)}}function zn(i,n){if(i&1&&(p(0,"p"),d(1),S(2,"date"),l()),i&2){let o=c().$implicit;s(),b("Arrival: ",k(2,1,o.arrival,"dd/MM HH:mm"),"")}}function Bn(i,n){if(i&1&&(p(0,"p"),d(1),S(2,"date"),l()),i&2){let o=c().$implicit;s(),b("Departure: ",k(2,1,o.departure,"dd/MM HH:mm"),"")}}function Ln(i,n){if(i&1&&(kt(0)(1),p(2,"mat-step",8),f(3,Fn,9,2,"ng-template",9),p(4,"div",10),f(5,zn,3,4,"p")(6,Bn,3,4,"p"),l()()),i&2){let o=n.$implicit,t=c(2);ie(o.station.id===t.data.from),s(),ie(o.station.id===t.data.to),s(4),v(o.arrival?5:-1),s(),v(o.departure?6:-1)}}function An(i,n){if(i&1&&(p(0,"mat-stepper",6,0),T(2,Ln,7,4,"mat-step",8,B),l()),i&2){let o=c();s(2),D(o.routeData())}}var Vi=(()=>{let n=class n{constructor(){this.dialogRef=u(jt),this.data=u(Ht),this.isLoading=ct(!0),this.routeData=ct([]),this.rideStore=u(Ut),this.stationStore=u(rt)}ngOnInit(){Promise.all([this.rideStore.getRide(this.data.rideId),this.stationStore.getStations()]).then(()=>{this.initRouteData(),this.isLoading.set(!1)})}initRouteData(){let t=this.rideStore.ridesEntityMap()[this.data.rideId],e=this.stationStore.stationsEntityMap(),r=t.path.map(_=>e[_]),{segments:a}=t.schedule,m=ci(r,a);this.routeData.set(m)}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=x({type:n,selectors:[["app-route-modal"]],standalone:!0,features:[C],decls:10,vars:2,consts:[["stepper",""],["mat-dialog-title","",1,"header"],[1,"spacer"],["mat-icon-button","","mat-dialog-close",""],[1,"content"],[1,"content-loading"],["orientation","vertical"],[3,"loadText"],["completed","false"],["matStepLabel",""],[1,"schedule"],[1,"step-label"],[1,"dwell"]],template:function(e,r){e&1&&(p(0,"h2",1),d(1),y(2,"span",2),p(3,"button",3)(4,"mat-icon"),d(5,"close"),l()()(),y(6,"mat-divider"),p(7,"mat-dialog-content",4),f(8,wn,2,1,"div",5)(9,An,4,0,"mat-stepper",6),l()),e&2&&(s(),b(" Route ",r.data.rideId," "),s(7),v(r.isLoading()?8:9))},dependencies:[$t,Qt,Nt,Ze,Pt,Rt,nt,et,Ai,xe,bt,Yt,ot],styles:["[_nghost-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:.5rem;margin-bottom:0}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{margin:0 1rem}[_nghost-%COMP%]   .content-loading[_ngcontent-%COMP%]{width:350px;height:350px;position:relative}[_nghost-%COMP%]   .step-label[_ngcontent-%COMP%]{display:flex;align-items:center;width:350px}@media (max-width: 1200px){[_nghost-%COMP%]   .step-label[_ngcontent-%COMP%]{width:300px}}@media (max-width: 768px){[_nghost-%COMP%]   .step-label[_ngcontent-%COMP%]{width:200px}}[_nghost-%COMP%]   .spacer[_ngcontent-%COMP%]{margin:0 auto}[_nghost-%COMP%]   .dwell[_ngcontent-%COMP%]{display:flex;align-items:center}"],changeDetection:0});let i=n;return i})();var ji=(()=>{let n=class n{constructor(){this.dialogRef=u(jt),this.data=u(Ht)}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=x({type:n,selectors:[["app-order-dialog"]],standalone:!0,features:[C],decls:8,vars:6,consts:[["mat-dialog-title",""],["mat-button","","mat-dialog-close",""]],template:function(e,r){e&1&&(p(0,"h2",0),d(1,"Order completed!"),l(),p(2,"mat-dialog-content"),d(3),S(4,"date"),l(),p(5,"mat-dialog-actions")(6,"button",1),d(7,"Close"),l()()),e&2&&(s(3),Ve("You have booked a trip from ",r.data.from.city," to ",r.data.to.city," on ",k(4,3,r.data.departure,"MMMM d, HH:mm"),"."))},dependencies:[Ci,Qt,et,it,Nt,$t],changeDetection:0});let i=n;return i})();function jn(i,n){if(i&1&&(p(0,"p",2),d(1),p(2,"span"),d(3),S(4,"currency"),l()()),i&2){let o=n.$implicit;s(),X(" Car ",o.carId,", Seat ",o.seatNumber," "),s(2),z(_t(4,3,o.price))}}function Hn(i,n){if(i&1){let o=F();p(0,"mat-card",0)(1,"mat-card-content",1),T(2,jn,5,5,"p",2,B),p(4,"p",3),d(5),S(6,"currency"),l()(),y(7,"mat-divider",4),p(8,"mat-card-footer",5)(9,"button",6),w("click",function(){M(o);let e=c();return I(e.onBook())}),d(10," Book seat "),l()()()}if(i&2){let o=c();s(2),D(o.bookItems()),s(3),b("Total: ",_t(6,1,o.totalPrice()),"")}}var Se=(()=>{let n=class n{constructor(t){this.snackBarService=t,this.bookItems=Tt.required(),this.totalPrice=R(()=>this.bookItems().reduce((e,r)=>e+r.price,0)),this.bookClick=Fe()}onBook(){if(this.bookItems().length!==1){this.snackBarService.open(zt.SelectedTooManySeats);return}this.bookClick.emit(!0)}};n.\u0275fac=function(e){return new(e||n)(h(Bt))},n.\u0275cmp=x({type:n,selectors:[["app-book-modal"]],inputs:{bookItems:[1,"bookItems"]},outputs:{bookClick:"bookClick"},standalone:!0,features:[C],decls:1,vars:1,consts:[["appearance","outlined",1,"card"],[1,"card-content"],[1,"book-item"],[1,"total"],[1,"divider"],[1,"card-footer"],["mat-flat-button","",1,"book-button",3,"click"]],template:function(e,r){e&1&&f(0,Hn,11,3,"mat-card",0),e&2&&v(r.totalPrice()?0:-1)},dependencies:[it,Si,Mi,yi,Ot,Rt],styles:["[_nghost-%COMP%]{font-weight:500}[_nghost-%COMP%]   .card-content[_ngcontent-%COMP%], [_nghost-%COMP%]   .card-footer[_ngcontent-%COMP%]{padding:1rem}[_nghost-%COMP%]   .book-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between}[_nghost-%COMP%]   .total[_ngcontent-%COMP%]{display:flex;justify-content:right}[_nghost-%COMP%]   .book-button[_ngcontent-%COMP%]{width:100%}"],changeDetection:0});let i=n;return i})();var Hi={ride:{rideId:0,path:[],carriages:[],schedule:{segments:[]}},carriages:[]};var Zt=Lt({providedIn:"root"},fi(Hi),ui(({carriages:i})=>({availableSeatsMap:R(()=>si(i())),seatScopes:R(()=>pi(i())),carriagesByTypeMap:R(()=>oi(i()))})),At((i,n=u(vi),o=u(Ut),t=u(rt))=>({async initStore(e){await o.getRide(e);let r=o.ridesEntityMap();r[e]&&(await n.getCarriages(),await t.getStations(),H(i,{ride:r[e]}),this.createTripCarriages())},selectedToReserved(){let r=i.carriages().map(a=>{let m=a.seats.map(_=>_.state===O.Selected?st(at({},_),{state:O.Reserved}):_);return st(at({},a),{seats:m})});H(i,{carriages:r})},toggleSeatState(e,r){let a=i.carriages(),_=a.find(N=>N.code===e).seats.find(N=>N.number===r);_&&(_.state=_.state===O.Available?O.Selected:O.Available,H(i,{carriages:[...a]}))},initOccupiedSeats(e){let r=i.carriages(),a=i.seatScopes(),m=r.map((_,N)=>{let{from:Ct,to:Jt}=a[N],Xt=e.filter(W=>W>=Ct&&W<=Jt).map(W=>W-Ct+1);return st(at({},_),{seats:ni(_,Xt)})});H(i,{carriages:m})},createTripCarriages(){let e=i.ride(),r=n.carriagesEntityMap(),a=[];for(let m=0;m<e.carriages.length;m+=1){let _=r[e.carriages[m]];a.push(st(at({},_),{code:(m+1).toString()}))}H(i,{carriages:a})}})));function $n(i,n){if(i&1){let o=F();p(0,"mat-list-item",1)(1,"app-train-car",2),w("toggleSeat",function(e){let r=M(o).$implicit,a=c();return I(a.onToggleSeat(e,r.code))}),l()()}if(i&2){let o=n.$implicit;s(),Ae("title","Carriage ",o.code,""),g("carriage",o)}}var ye=(()=>{let n=class n{constructor(t){this.trainCarService=t,this.carriages=Tt.required(),this.tripStore=u(Zt),this.availableCarriages=R(()=>this.carriages().filter(e=>!!this.trainCarService.getAvailableSeatsNumber(e)))}onToggleSeat(t,e){this.tripStore.toggleSeatState(e,t)}};n.\u0275fac=function(e){return new(e||n)(h(qt))},n.\u0275cmp=x({type:n,selectors:[["app-carriage-list"]],inputs:{carriages:[1,"carriages"]},standalone:!0,features:[ft([qt]),C],decls:3,vars:0,consts:[["role","list"],["role","listitem",1,"carriage"],[3,"toggleSeat","carriage","title"]],template:function(e,r){e&1&&(p(0,"mat-list",0),T(1,$n,2,3,"mat-list-item",1,B),l()),e&2&&(s(),D(r.availableCarriages()))},dependencies:[ei,Ft,ki],styles:["[_nghost-%COMP%]   .carriage[_ngcontent-%COMP%]{height:100%;margin:2rem 0}"],changeDetection:0});let i=n;return i})();var Ni=(()=>{let n=class n{constructor(){this.rideSegments=[],this.fromStation={},this.toStation={},this.tripStore=u(Zt),this.stationStore=u(rt),this.orderStore=u(Vt)}async initStore(t,e,r){await this.tripStore.initStore(t),await this.orderStore.getOrders(),this.initRideSegments(e,r),this.tripStore.initOccupiedSeats(this.getOccupiedSeats()),this.initEdgeStations(e,r)}getTripView(){return R(()=>{let t=this.tripStore.ride(),e=this.getTrainClasses(),r=this.rideSegments.slice(-1)[0];return{rideId:t.rideId,from:this.fromStation,to:this.toStation,departure:this.rideSegments[0].time[0],arrival:r.time[1],trainClasses:e}})}getBookItems(){return R(()=>{let t=this.tripStore.carriages(),e=[];return t.forEach(r=>{r.seats.filter(m=>m.state===O.Selected).forEach(m=>{e.push({carId:r.code,seatNumber:m.number,price:this.priceMap[r.name]})})}),e})}async createOrder(t){let e=this.getTripView()(),{rideId:r}=e,a=e.from.id,m=e.to.id,_=this.tripStore.carriages(),N=t.map(async Ct=>{let{seatNumber:Jt,carId:Xt}=Ct,W=_.findIndex(Qi=>Qi.code===Xt),$i=li(_,W,Jt);return this.orderStore.createOrder(r,$i,a,m)});await Promise.all(N),this.tripStore.selectedToReserved()}get segments(){return this.rideSegments}getTrainClasses(){let t=this.tripStore.carriagesByTypeMap(),e=this.tripStore.availableSeatsMap();return Object.entries(t).map(([r,a])=>{let m=this.priceMap[r],_=e[r];return{name:r,carriages:a,price:m,availableSeats:_}})}getOccupiedSeats(){let t=new Set;return this.rideSegments.forEach(e=>{e.occupiedSeats?.forEach(r=>{t.add(r)})}),Array.from(t.values())}initRideSegments(t,e){let r=this.tripStore.ride();this.rideSegments=ai(r,t,e)}initEdgeStations(t,e){let r=this.stationStore.stationsEntityMap();this.fromStation=r[t],this.toStation=r[e]}get priceMap(){return ri(this.rideSegments)}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=yt({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();function Un(i,n){i&1&&y(0,"app-spinner",0),i&2&&g("loadText","Loading the trip...")}function Gn(i,n){if(i&1&&(p(0,"mat-list-item")(1,"p",17),d(2),l(),p(3,"p",18),d(4),S(5,"currency"),l()()),i&2){let o=c().$implicit;s(2),X(" Carriage type ",o.name,": ",o.availableSeats," "),s(2),b(" ",_t(5,3,o.price)," ")}}function Kn(i,n){if(i&1&&(p(0,"mat-tab"),f(1,Gn,6,5,"ng-template",15),y(2,"app-carriage-list",16),l()),i&2){let o=n.$implicit;s(2),g("carriages",o.carriages)}}function Wn(i,n){if(i&1&&(p(0,"div",14),y(1,"app-car-seat",19),d(2),l()),i&2){let o=n.$implicit;s(),g("seat",o.seat)("direction","right"),s(),b(" ",o.description," ")}}function Yn(i,n){if(i&1){let o=F();kt(0),p(1,"div",1)(2,"div",2)(3,"button",3),w("click",function(){M(o);let e=c();return I(e.onBack())}),p(4,"mat-icon"),d(5,"arrow_back"),l()()(),p(6,"div",4)(7,"div",5)(8,"div",6)(9,"mat-icon"),d(10,"directions_subway"),l(),d(11),l(),p(12,"p"),d(13),S(14,"date"),S(15,"date"),l()(),p(16,"p")(17,"span"),d(18),l(),p(19,"button",7),w("click",function(){M(o);let e=c();return I(e.onRoute())}),p(20,"mat-icon"),d(21,"keyboard_arrow_down"),l(),d(22," Route "),l()()()(),p(23,"div",8)(24,"div",9)(25,"mat-tab-group",10),T(26,Kn,3,1,"mat-tab",null,B),l()(),p(28,"div",11)(29,"app-book-modal",12),w("bookClick",function(){M(o);let e=c();return I(e.onBook())}),l()(),p(30,"div",13),T(31,Wn,3,3,"div",14,B),l()()}if(i&2){let o=c(),t=o.tripView();s(11),X(" ",t.from.city," \u21D2 ",t.to.city," "),s(2),X(" ",k(14,6,t.departure,"MMMM d, HH:mm")," \u21D2 ",k(15,9,t.arrival,"MMMM d, HH:mm")," "),s(5),b("Ride ",o.tripView().rideId,""),s(8),D(t.trainClasses),s(3),g("bookItems",o.bookItems()),s(2),D(o.legendSeats)}}var xa=(()=>{let n=class n{constructor(t,e,r,a){this.router=t,this.activatedRoute=e,this.snackBarService=r,this.tripService=a,this.isLoading=ct(!0),this.dialog=u(bi),this.orderStore=u(Vt)}ngOnInit(){let t=Number(this.activatedRoute.snapshot.paramMap.get("rideId")),e=Number(this.activatedRoute.snapshot.queryParams.from),r=Number(this.activatedRoute.snapshot.queryParams.to);if(!t||!e||!r){this.router.navigate(["/404"]);return}this.bookItems=this.tripService.getBookItems(),this.initTripView(t,e,r)}onBook(){let{rideId:t}=this.tripView();if(this.orderStore.hasOrder(t)){this.snackBarService.open(zt.AlreadyBooked);return}this.tripService.createOrder(this.bookItems()).then(()=>{this.dialog.open(ji,{data:this.tripView()})}).catch(e=>this.snackBarService.displayError(e))}onBack(){this.router.navigate([ii.Search])}onRoute(){this.dialog.open(Vi,{data:{rideId:this.tripView().rideId,from:this.tripView().from.id,to:this.tripView().to.id}})}get legendSeats(){return[{description:"Reserved seat",seat:{number:1,state:O.Reserved}},{description:"Avilable seat",seat:{number:1,state:O.Available}},{description:"Selected seat",seat:{number:1,state:O.Selected}}]}async initTripView(t,e,r){if(this.isLoading.set(!0),await this.tripService.initStore(t,e,r),!(this.tripService.segments.length>0)){this.router.navigate(["/404"]);return}this.tripView=this.tripService.getTripView(),this.isLoading.set(!1)}};n.\u0275fac=function(e){return new(e||n)(h(ti),h(Xe),h(Bt),h(Ni))},n.\u0275cmp=x({type:n,selectors:[["app-trip"]],standalone:!0,features:[C],decls:2,vars:1,consts:[[3,"loadText"],[1,"head"],[1,"head-back"],["mat-icon-button","",3,"click"],[1,"head-info"],[1,"head-stations"],[1,"head-cities"],["mat-button","",3,"click"],[1,"body"],[1,"carriages"],["animationDuration","0ms","mat-stretch-tabs","false","mat-align-tabs","start"],[1,"book-modal"],[3,"bookClick","bookItems"],[1,"legend"],[1,"legend-item"],["mat-tab-label",""],[3,"carriages"],["matListItemTitle",""],["matListItemLine",""],[3,"seat","direction"]],template:function(e,r){e&1&&f(0,Un,1,1,"app-spinner",0)(1,Yn,33,12),e&2&&v(r.isLoading()?0:1)},dependencies:[he,et,ye,wi,Ii,Ti,Di,Se,nt,Ft,Ot,Pt,it,ot],styles:["[_nghost-%COMP%]   .head[_ngcontent-%COMP%]{background-color:#f2f2f2;padding:1rem 5rem;font-weight:500;display:flex}@media (max-width: 768px){[_nghost-%COMP%]   .head[_ngcontent-%COMP%]{padding:.5rem}}[_nghost-%COMP%]   .head[_ngcontent-%COMP%]   .head-info[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .head[_ngcontent-%COMP%]   .head-info[_ngcontent-%COMP%]   .head-stations[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;font-size:1.2rem}[_nghost-%COMP%]   .head[_ngcontent-%COMP%]   .head-info[_ngcontent-%COMP%]   .head-stations[_ngcontent-%COMP%]   .head-cities[_ngcontent-%COMP%]{display:flex;align-items:center}[_nghost-%COMP%]   .body[_ngcontent-%COMP%]{margin-top:1rem;padding:0 5rem 5rem}@media (max-width: 768px){[_nghost-%COMP%]   .body[_ngcontent-%COMP%]{padding:0}}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]{display:flex;justify-content:center}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{margin-right:2rem}[_nghost-%COMP%]   .book-modal[_ngcontent-%COMP%]{width:20rem}@media (max-width: 1199px){[_nghost-%COMP%]   .book-modal[_ngcontent-%COMP%]{margin:0 auto}}@media (min-width: 1200px){[_nghost-%COMP%]   .book-modal[_ngcontent-%COMP%]{position:fixed;z-index:1;top:70%;right:4rem;transform:translateY(-50%)}}"],changeDetection:0});let i=n;return i})();export{xa as TripComponent};
