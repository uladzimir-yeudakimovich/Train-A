import{a as he,b as qt,c as Oi}from"./chunk-PBP6QLVX.js";import{a as Ii,b as Ti,c as Di,d as wi}from"./chunk-SZOZ327I.js";import{a as Si,c as Mi,g as yi}from"./chunk-VZ4HLSKR.js";import{a as nt,b as ti}from"./chunk-E3YR2YRX.js";import"./chunk-YW5HVEMI.js";import{a as rt}from"./chunk-QRW435WX.js";import{a as Qt}from"./chunk-53VXDIFN.js";import{a as jt,b as Vt,c as xi,d as Ht,e as Nt,f as $t,g as bi}from"./chunk-T4W7GD3U.js";import{b as At}from"./chunk-DCFEK5NY.js";import{a as ri,b as oi,c as ai,d as si,e as pi,f as li,h as ci,j as Ci}from"./chunk-GDYXRNEI.js";import{a as k,b as ni,c as vi}from"./chunk-YINHOYAG.js";import{A as mi,B as hi,R as zt,T as H,U as Bt,V as ui,W as Lt,X as fi,_ as gi,a as it,ca as _i,d as Et,e as Xe,g as Ft,j as se,k as pe,l as le,n as U,o as G,q as ce,r as de,s as me,x as di}from"./chunk-7T747AWH.js";import{a as ei,b as Rt}from"./chunk-AXXYKBND.js";import{a as Pt}from"./chunk-WTT3E6IK.js";import{a as ii}from"./chunk-ZWL73D3D.js";import{a as $e,c as Qe}from"./chunk-IE527E7W.js";import"./chunk-JHSZ4YJF.js";import{C as Ue,F as Ge,V as Ke,_ as We,aa as kt,ba as Ye,ea as ae,j as oe,ja as vt,k as et,l as Ot,m as Ne,ma as Ze,na as Je,w as qe}from"./chunk-Y6UWJUYI.js";import{$ as Y,Aa as Pe,Ab as te,Ac as ft,Ba as y,Bc as S,Ca as I,Cc as gt,Db as f,Dc as O,Eb as dt,Fa as Re,Fb as v,Fc as Ve,Hb as V,Ib as Be,Jb as Le,Ka as Z,Kb as _,Lb as B,Mb as Tt,Na as Fe,Nb as T,Oa as It,Ob as D,Pa as J,Pb as s,Pc as _t,Qa as pt,Qb as l,R as De,Rb as M,Tc as tt,Ub as q,Uc as He,Vb as F,Vc as R,_b as w,a as ot,aa as we,ac as d,b as at,ba as $,bc as mt,cc as ht,dc as Ae,ec as L,fa as bt,fc as Dt,g as ye,ga as St,gc as E,ha as Mt,hc as P,ib as p,ja as Oe,jb as h,l as st,lb as Q,lc as ee,ma as u,mc as c,nc as z,oa as ke,oc as x,pa as Ee,pc as X,qc as je,ra as C,sa as yt,sb as ze,t as Ie,ta as j,ub as lt,uc as wt,vc as ie,wc as ne,xc as ut,y as Te,yb as ct,yc as b,zc as re}from"./chunk-XM6RWNSX.js";var ue={entity:void 0,collection:"rides",selectId:i=>i.rideId};var Ut=Bt({providedIn:"root"},_i(ue),Lt((i,n=u(Ci))=>({async getRide(o){let t=await n.loadRide(o);H(i,gi(t,ue))}})));var Wi=["*"];function Yi(i,n){i&1&&ht(0)}var fe=(()=>{let n=class n{constructor(t){this._elementRef=t}focus(){this._elementRef.nativeElement.focus()}};n.\u0275fac=function(e){return new(e||n)(h(J))},n.\u0275dir=j({type:n,selectors:[["","cdkStepHeader",""]],hostAttrs:["role","tab"],standalone:!0});let i=n;return i})(),ge=(()=>{let n=class n{constructor(t){this.template=t}};n.\u0275fac=function(e){return new(e||n)(h(Q))},n.\u0275dir=j({type:n,selectors:[["","cdkStepLabel",""]],standalone:!0});let i=n;return i})(),Zi=0;var A={NUMBER:"number",EDIT:"edit",DONE:"done",ERROR:"error"},_e=new Oe("STEPPER_GLOBAL_OPTIONS"),Gt=(()=>{let n=class n{get completed(){return this._completedOverride==null?this._getDefaultCompleted():this._completedOverride}set completed(t){this._completedOverride=t}_getDefaultCompleted(){return this.stepControl?this.stepControl.valid&&this.interacted:this.interacted}get hasError(){return this._customError==null?this._getDefaultError():this._customError}set hasError(t){this._customError=t}_getDefaultError(){return this.stepControl&&this.stepControl.invalid&&this.interacted}constructor(t,e){this._stepper=t,this.interacted=!1,this.interactedStream=new Z,this.editable=!0,this.optional=!1,this._completedOverride=null,this._customError=null,this._stepperOptions=e||{},this._displayDefaultIndicatorType=this._stepperOptions.displayDefaultIndicatorType!==!1}select(){this._stepper.selected=this}reset(){this.interacted=!1,this._completedOverride!=null&&(this._completedOverride=!1),this._customError!=null&&(this._customError=!1),this.stepControl&&this.stepControl.reset()}ngOnChanges(){this._stepper._stateChanged()}_markAsInteracted(){this.interacted||(this.interacted=!0,this.interactedStream.emit(this))}_showError(){return this._stepperOptions.showError??this._customError!=null}};n.\u0275fac=function(e){return new(e||n)(h(bt(()=>Kt)),h(_e,8))},n.\u0275cmp=C({type:n,selectors:[["cdk-step"]],contentQueries:function(e,r,a){if(e&1&&L(a,ge,5),e&2){let m;E(m=P())&&(r.stepLabel=m.first)}},viewQuery:function(e,r){if(e&1&&Dt(Q,7),e&2){let a;E(a=P())&&(r.content=a.first)}},inputs:{stepControl:"stepControl",label:"label",errorMessage:"errorMessage",ariaLabel:[0,"aria-label","ariaLabel"],ariaLabelledby:[0,"aria-labelledby","ariaLabelledby"],state:"state",editable:[2,"editable","editable",tt],optional:[2,"optional","optional",tt],completed:[2,"completed","completed",tt],hasError:[2,"hasError","hasError",tt]},outputs:{interactedStream:"interacted"},exportAs:["cdkStep"],standalone:!0,features:[te,Pe,b],ngContentSelectors:Wi,decls:1,vars:0,template:function(e,r){e&1&&(mt(),f(0,Yi,1,0,"ng-template"))},encapsulation:2,changeDetection:0});let i=n;return i})(),Kt=(()=>{let n=class n{get selectedIndex(){return this._selectedIndex}set selectedIndex(t){this.steps&&this._steps?(this._isValidIndex(t),this.selected?._markAsInteracted(),this._selectedIndex!==t&&!this._anyControlsInvalidOrPending(t)&&(t>=this._selectedIndex||this.steps.toArray()[t].editable)&&this._updateSelectedItemIndex(t)):this._selectedIndex=t}get selected(){return this.steps?this.steps.toArray()[this.selectedIndex]:void 0}set selected(t){this.selectedIndex=t&&this.steps?this.steps.toArray().indexOf(t):-1}get orientation(){return this._orientation}set orientation(t){this._orientation=t,this._keyManager&&this._keyManager.withVerticalOrientation(t==="vertical")}constructor(t,e,r){this._dir=t,this._changeDetectorRef=e,this._elementRef=r,this._destroyed=new st,this.steps=new pt,this._sortedHeaders=new pt,this.linear=!1,this._selectedIndex=0,this.selectionChange=new Z,this.selectedIndexChange=new Z,this._orientation="horizontal",this._groupId=Zi++}ngAfterContentInit(){this._steps.changes.pipe(Y(this._steps),$(this._destroyed)).subscribe(t=>{this.steps.reset(t.filter(e=>e._stepper===this)),this.steps.notifyOnChanges()})}ngAfterViewInit(){this._stepHeader.changes.pipe(Y(this._stepHeader),$(this._destroyed)).subscribe(t=>{this._sortedHeaders.reset(t.toArray().sort((e,r)=>e._elementRef.nativeElement.compareDocumentPosition(r._elementRef.nativeElement)&Node.DOCUMENT_POSITION_FOLLOWING?-1:1)),this._sortedHeaders.notifyOnChanges()}),this._keyManager=new Ke(this._sortedHeaders).withWrap().withHomeAndEnd().withVerticalOrientation(this._orientation==="vertical"),(this._dir?this._dir.change:Ie()).pipe(Y(this._layoutDirection()),$(this._destroyed)).subscribe(t=>this._keyManager.withHorizontalOrientation(t)),this._keyManager.updateActiveItem(this._selectedIndex),this.steps.changes.subscribe(()=>{this.selected||(this._selectedIndex=Math.max(this._selectedIndex-1,0))}),this._isValidIndex(this._selectedIndex)||(this._selectedIndex=0)}ngOnDestroy(){this._keyManager?.destroy(),this.steps.destroy(),this._sortedHeaders.destroy(),this._destroyed.next(),this._destroyed.complete()}next(){this.selectedIndex=Math.min(this._selectedIndex+1,this.steps.length-1)}previous(){this.selectedIndex=Math.max(this._selectedIndex-1,0)}reset(){this._updateSelectedItemIndex(0),this.steps.forEach(t=>t.reset()),this._stateChanged()}_getStepLabelId(t){return`cdk-step-label-${this._groupId}-${t}`}_getStepContentId(t){return`cdk-step-content-${this._groupId}-${t}`}_stateChanged(){this._changeDetectorRef.markForCheck()}_getAnimationDirection(t){let e=t-this._selectedIndex;return e<0?this._layoutDirection()==="rtl"?"next":"previous":e>0?this._layoutDirection()==="rtl"?"previous":"next":"current"}_getIndicatorType(t,e=A.NUMBER){let r=this.steps.toArray()[t],a=this._isCurrentStep(t);return r._displayDefaultIndicatorType?this._getDefaultIndicatorLogic(r,a):this._getGuidelineLogic(r,a,e)}_getDefaultIndicatorLogic(t,e){return t._showError()&&t.hasError&&!e?A.ERROR:!t.completed||e?A.NUMBER:t.editable?A.EDIT:A.DONE}_getGuidelineLogic(t,e,r=A.NUMBER){return t._showError()&&t.hasError&&!e?A.ERROR:t.completed&&!e?A.DONE:t.completed&&e?r:t.editable&&e?A.EDIT:r}_isCurrentStep(t){return this._selectedIndex===t}_getFocusIndex(){return this._keyManager?this._keyManager.activeItemIndex:this._selectedIndex}_updateSelectedItemIndex(t){let e=this.steps.toArray();this.selectionChange.emit({selectedIndex:t,previouslySelectedIndex:this._selectedIndex,selectedStep:e[t],previouslySelectedStep:e[this._selectedIndex]}),this._containsFocus()?this._keyManager.setActiveItem(t):this._keyManager.updateActiveItem(t),this._selectedIndex=t,this.selectedIndexChange.emit(this._selectedIndex),this._stateChanged()}_onKeydown(t){let e=Ge(t),r=t.keyCode,a=this._keyManager;a.activeItemIndex!=null&&!e&&(r===32||r===13)?(this.selectedIndex=a.activeItemIndex,t.preventDefault()):a.setFocusOrigin("keyboard").onKeydown(t)}_anyControlsInvalidOrPending(t){return this.linear&&t>=0?this.steps.toArray().slice(0,t).some(e=>{let r=e.stepControl;return(r?r.invalid||r.pending||!e.interacted:!e.completed)&&!e.optional&&!e._completedOverride}):!1}_layoutDirection(){return this._dir&&this._dir.value==="rtl"?"rtl":"ltr"}_containsFocus(){let t=this._elementRef.nativeElement,e=Ue();return t===e||t.contains(e)}_isValidIndex(t){return t>-1&&(!this.steps||t<this.steps.length)}};n.\u0275fac=function(e){return new(e||n)(h(kt,8),h(_t),h(J))},n.\u0275dir=j({type:n,selectors:[["","cdkStepper",""]],contentQueries:function(e,r,a){if(e&1&&(L(a,Gt,5),L(a,fe,5)),e&2){let m;E(m=P())&&(r._steps=m),E(m=P())&&(r._stepHeader=m)}},inputs:{linear:[2,"linear","linear",tt],selectedIndex:[2,"selectedIndex","selectedIndex",He],selected:"selected",orientation:"orientation"},outputs:{selectionChange:"selectionChange",selectedIndexChange:"selectedIndexChange"},exportAs:["cdkStepper"],standalone:!0,features:[te]});let i=n;return i})();var ki=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=yt({type:n}),n.\u0275inj=Mt({imports:[Ye]});let i=n;return i})();function Ji(i,n){if(i&1&&q(0,2),i&2){let o=d();v("ngTemplateOutlet",o.iconOverrides[o.state])("ngTemplateOutletContext",o._getIconContext())}}function Xi(i,n){if(i&1&&(s(0,"span",7),c(1),l()),i&2){let o=d(2);p(),z(o._getDefaultTextForState(o.state))}}function tn(i,n){if(i&1&&(s(0,"span",8),c(1),l()),i&2){let o=d(3);p(),z(o._intl.completedLabel)}}function en(i,n){if(i&1&&(s(0,"span",8),c(1),l()),i&2){let o=d(3);p(),z(o._intl.editableLabel)}}function nn(i,n){if(i&1&&(f(0,tn,2,1,"span",8)(1,en,2,1,"span",8),s(2,"mat-icon",7),c(3),l()),i&2){let o=d(2);_(o.state==="done"?0:o.state==="edit"?1:-1),p(3),z(o._getDefaultTextForState(o.state))}}function rn(i,n){if(i&1&&f(0,Xi,2,1,"span",7)(1,nn,4,2,"mat-icon",7),i&2){let o,t=d();_((o=t.state)==="number"?0:1)}}function on(i,n){i&1&&(s(0,"div",4),q(1,9),l()),i&2&&(p(),v("ngTemplateOutlet",n.template))}function an(i,n){if(i&1&&(s(0,"div",4),c(1),l()),i&2){let o=d();p(),z(o.label)}}function sn(i,n){if(i&1&&(s(0,"div",5),c(1),l()),i&2){let o=d();p(),z(o._intl.optionalLabel)}}function pn(i,n){if(i&1&&(s(0,"div",6),c(1),l()),i&2){let o=d();p(),z(o.errorMessage)}}var Pi=["*"];function ln(i,n){}function cn(i,n){if(i&1&&(ht(0),f(1,ln,0,0,"ng-template",0)),i&2){let o=d();p(),v("cdkPortalOutlet",o._portal)}}var Ri=(i,n)=>({step:i,i:n}),Fi=i=>({animationDuration:i}),zi=(i,n)=>({value:i,params:n});function dn(i,n){i&1&&ht(0)}function mn(i,n){i&1&&M(0,"div",6)}function hn(i,n){if(i&1&&(q(0,5),f(1,mn,1,0,"div",6)),i&2){let o=n.$implicit,t=n.$index,e=n.$count;d(2);let r=ee(4);v("ngTemplateOutlet",r)("ngTemplateOutletContext",ft(3,Ri,o,t)),p(),_(t!==e-1?1:-1)}}function un(i,n){if(i&1){let o=F();s(0,"div",7),w("@horizontalStepTransition.done",function(e){y(o);let r=d(2);return I(r._animationDone.next(e))}),q(1,8),l()}if(i&2){let o=n.$implicit,t=n.$index,e=d(2);V("mat-horizontal-stepper-content-inactive",e.selectedIndex!==t),v("@horizontalStepTransition",ft(8,zi,e._getAnimationDirection(t),re(6,Fi,e._getAnimationDuration())))("id",e._getStepContentId(t)),dt("aria-labelledby",e._getStepLabelId(t)),p(),v("ngTemplateOutlet",o.content)}}function fn(i,n){if(i&1&&(s(0,"div",1)(1,"div",2),T(2,hn,2,6,null,null,Tt),l(),s(4,"div",3),T(5,un,2,11,"div",4,Tt),l()()),i&2){let o=d();p(2),D(o.steps),p(3),D(o.steps)}}function gn(i,n){if(i&1){let o=F();s(0,"div",9),q(1,5),s(2,"div",10)(3,"div",11),w("@verticalStepTransition.done",function(e){y(o);let r=d(2);return I(r._animationDone.next(e))}),s(4,"div",12),q(5,8),l()()()()}if(i&2){let o=n.$implicit,t=n.$index,e=n.$count,r=d(2),a=ee(4);p(),v("ngTemplateOutlet",a)("ngTemplateOutletContext",ft(10,Ri,o,t)),p(),V("mat-stepper-vertical-line",t!==e-1),p(),V("mat-vertical-stepper-content-inactive",r.selectedIndex!==t),v("@verticalStepTransition",ft(15,zi,r._getAnimationDirection(t),re(13,Fi,r._getAnimationDuration())))("id",r._getStepContentId(t)),dt("aria-labelledby",r._getStepLabelId(t)),p(2),v("ngTemplateOutlet",o.content)}}function _n(i,n){if(i&1&&T(0,gn,6,18,"div",9,Tt),i&2){let o=d();D(o.steps)}}function vn(i,n){if(i&1){let o=F();s(0,"mat-step-header",13),w("click",function(){let e=y(o).step;return I(e.select())})("keydown",function(e){y(o);let r=d();return I(r._onKeydown(e))}),l()}if(i&2){let o=n.step,t=n.i,e=d();V("mat-horizontal-stepper-header",e.orientation==="horizontal")("mat-vertical-stepper-header",e.orientation==="vertical"),v("tabIndex",e._getFocusIndex()===t?0:-1)("id",e._getStepLabelId(t))("index",t)("state",e._getIndicatorType(t,o.state))("label",o.stepLabel||o.label)("selected",e.selectedIndex===t)("active",e._stepIsNavigable(t,o))("optional",o.optional)("errorMessage",o.errorMessage)("iconOverrides",e._iconOverrides)("disableRipple",e.disableRipple||!e._stepIsNavigable(t,o))("color",o.color||e.color),dt("aria-posinset",t+1)("aria-setsize",e.steps.length)("aria-controls",e._getStepContentId(t))("aria-selected",e.selectedIndex==t)("aria-label",o.ariaLabel||null)("aria-labelledby",!o.ariaLabel&&o.ariaLabelledby?o.ariaLabelledby:null)("aria-disabled",e._stepIsNavigable(t,o)?null:!0)}}var Ct=(()=>{let n=class n extends ge{};n.\u0275fac=(()=>{let t;return function(r){return(t||(t=Re(n)))(r||n)}})(),n.\u0275dir=j({type:n,selectors:[["","matStepLabel",""]],standalone:!0,features:[ct]});let i=n;return i})(),Wt=(()=>{let n=class n{constructor(){this.changes=new st,this.optionalLabel="Optional",this.completedLabel="Completed",this.editableLabel="Editable"}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();function Cn(i){return i||new Wt}var xn={provide:Wt,deps:[[new ke,new Ee,Wt]],useFactory:Cn},ve=(()=>{let n=class n extends fe{constructor(t,e,r,a){super(r),this._intl=t,this._focusMonitor=e,this._intlSubscription=t.changes.subscribe(()=>a.markForCheck())}ngAfterViewInit(){this._focusMonitor.monitor(this._elementRef,!0)}ngOnDestroy(){this._intlSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._elementRef)}focus(t,e){t?this._focusMonitor.focusVia(this._elementRef,t,e):this._elementRef.nativeElement.focus(e)}_stringLabel(){return this.label instanceof Ct?null:this.label}_templateLabel(){return this.label instanceof Ct?this.label:null}_getHostElement(){return this._elementRef.nativeElement}_getIconContext(){return{index:this.index,active:this.active,optional:this.optional}}_getDefaultTextForState(t){return t=="number"?`${this.index+1}`:t=="edit"?"create":t=="error"?"warning":t}};n.\u0275fac=function(e){return new(e||n)(h(Wt),h(We),h(J),h(_t))},n.\u0275cmp=C({type:n,selectors:[["mat-step-header"]],hostAttrs:["role","tab",1,"mat-step-header"],hostVars:2,hostBindings:function(e,r){e&2&&Be("mat-"+(r.color||"primary"))},inputs:{state:"state",label:"label",errorMessage:"errorMessage",iconOverrides:"iconOverrides",index:"index",selected:"selected",active:"active",optional:"optional",disableRipple:"disableRipple",color:"color"},standalone:!0,features:[ct,b],decls:10,vars:17,consts:[["matRipple","",1,"mat-step-header-ripple","mat-focus-indicator",3,"matRippleTrigger","matRippleDisabled"],[1,"mat-step-icon-content"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-step-label"],[1,"mat-step-text-label"],[1,"mat-step-optional"],[1,"mat-step-sub-label-error"],["aria-hidden","true"],[1,"cdk-visually-hidden"],[3,"ngTemplateOutlet"]],template:function(e,r){if(e&1&&(M(0,"div",0),s(1,"div")(2,"div",1),f(3,Ji,1,2,"ng-container",2)(4,rn,2,1),l()(),s(5,"div",3),f(6,on,2,1,"div",4)(7,an,2,1,"div",4)(8,sn,2,1,"div",5)(9,pn,2,1,"div",6),l()),e&2){let a;v("matRippleTrigger",r._getHostElement())("matRippleDisabled",r.disableRipple),p(),Le("mat-step-icon-state-",r.state," mat-step-icon"),V("mat-step-icon-selected",r.selected),p(2),_(r.iconOverrides&&r.iconOverrides[r.state]?3:4),p(2),V("mat-step-label-active",r.active)("mat-step-label-selected",r.selected)("mat-step-label-error",r.state=="error"),p(),_((a=r._templateLabel())?6:r._stringLabel()?7:-1,a),p(2),_(r.optional&&r.state!="error"?8:-1),p(),_(r.state==="error"?9:-1)}},dependencies:[Ze,oe,nt],styles:['.mat-step-header{overflow:hidden;outline:none;cursor:pointer;position:relative;box-sizing:content-box;-webkit-tap-highlight-color:rgba(0,0,0,0)}.mat-step-header:focus .mat-focus-indicator::before{content:""}.mat-step-header:hover[aria-disabled=true]{cursor:default}.mat-step-header:hover:not([aria-disabled]),.mat-step-header:hover[aria-disabled=false]{background-color:var(--mat-stepper-header-hover-state-layer-color);border-radius:var(--mat-stepper-header-hover-state-layer-shape, var(--mat-app-corner-medium))}.mat-step-header.cdk-keyboard-focused,.mat-step-header.cdk-program-focused{background-color:var(--mat-stepper-header-focus-state-layer-color);border-radius:var(--mat-stepper-header-focus-state-layer-shape, var(--mat-app-corner-medium))}@media(hover: none){.mat-step-header:hover{background:none}}.cdk-high-contrast-active .mat-step-header{outline:solid 1px}.cdk-high-contrast-active .mat-step-header[aria-selected=true] .mat-step-label{text-decoration:underline}.cdk-high-contrast-active .mat-step-header[aria-disabled=true]{outline-color:GrayText}.cdk-high-contrast-active .mat-step-header[aria-disabled=true] .mat-step-label,.cdk-high-contrast-active .mat-step-header[aria-disabled=true] .mat-step-icon,.cdk-high-contrast-active .mat-step-header[aria-disabled=true] .mat-step-optional{color:GrayText}.mat-step-optional{font-size:12px;color:var(--mat-stepper-header-optional-label-text-color, var(--mat-app-on-surface-variant))}.mat-step-sub-label-error{font-size:12px;font-weight:normal}.mat-step-icon{border-radius:50%;height:24px;width:24px;flex-shrink:0;position:relative;color:var(--mat-stepper-header-icon-foreground-color, var(--mat-app-surface));background-color:var(--mat-stepper-header-icon-background-color, var(--mat-app-on-surface-variant))}.mat-step-icon-content{position:absolute;top:50%;left:50%;transform:translate(-50%, -50%);display:flex}.mat-step-icon .mat-icon{font-size:16px;height:16px;width:16px}.mat-step-icon-state-error{background-color:var(--mat-stepper-header-error-state-icon-background-color);color:var(--mat-stepper-header-error-state-icon-foreground-color, var(--mat-app-error))}.mat-step-icon-state-error .mat-icon{font-size:24px;height:24px;width:24px}.mat-step-label{display:inline-block;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;min-width:50px;vertical-align:middle;font-family:var(--mat-stepper-header-label-text-font, var(--mat-app-title-small-font));font-size:var(--mat-stepper-header-label-text-size, var(--mat-app-title-small-size));font-weight:var(--mat-stepper-header-label-text-weight, var(--mat-app-title-small-weight));color:var(--mat-stepper-header-label-text-color, var(--mat-app-on-surface-variant))}.mat-step-label.mat-step-label-active{color:var(--mat-stepper-header-selected-state-label-text-color, var(--mat-app-on-surface-variant))}.mat-step-label.mat-step-label-error{color:var(--mat-stepper-header-error-state-label-text-color, var(--mat-app-error));font-size:var(--mat-stepper-header-error-state-label-text-size, var(--mat-app-title-small-size))}.mat-step-label.mat-step-label-selected{font-size:var(--mat-stepper-header-selected-state-label-text-size, var(--mat-app-title-small-size));font-weight:var(--mat-stepper-header-selected-state-label-text-weight, var(--mat-app-title-small-weight))}.mat-step-text-label{text-overflow:ellipsis;overflow:hidden}.mat-step-header .mat-step-header-ripple{top:0;left:0;right:0;bottom:0;position:absolute;pointer-events:none}.mat-step-icon-selected{background-color:var(--mat-stepper-header-selected-state-icon-background-color, var(--mat-app-primary));color:var(--mat-stepper-header-selected-state-icon-foreground-color, var(--mat-app-on-primary))}.mat-step-icon-state-done{background-color:var(--mat-stepper-header-done-state-icon-background-color);color:var(--mat-stepper-header-done-state-icon-foreground-color)}.mat-step-icon-state-edit{background-color:var(--mat-stepper-header-edit-state-icon-background-color, var(--mat-app-primary));color:var(--mat-stepper-header-edit-state-icon-foreground-color, var(--mat-app-on-primary))}'],encapsulation:2,changeDetection:0});let i=n;return i})(),Bi="500ms",Li="225ms",Ei={horizontalStepTransition:se("horizontalStepTransition",[G("previous",U({transform:"translate3d(-100%, 0, 0)",visibility:"hidden"})),G("current",U({transform:"none",visibility:"inherit"})),G("next",U({transform:"translate3d(100%, 0, 0)",visibility:"hidden"})),ce("* => *",le([pe("{{animationDuration}} cubic-bezier(0.35, 0, 0.25, 1)"),me("@*",de(),{optional:!0})]),{params:{animationDuration:Bi}})]),verticalStepTransition:se("verticalStepTransition",[G("previous",U({height:"0px",visibility:"hidden"})),G("next",U({height:"0px",visibility:"hidden"})),G("current",U({height:"*",visibility:"inherit"})),ce("* <=> current",le([pe("{{animationDuration}} cubic-bezier(0.4, 0.0, 0.2, 1)"),me("@*",de(),{optional:!0})]),{params:{animationDuration:Li}})])},bn=(()=>{let n=class n{constructor(t){this.templateRef=t}};n.\u0275fac=function(e){return new(e||n)(h(Q))},n.\u0275dir=j({type:n,selectors:[["ng-template","matStepperIcon",""]],inputs:{name:[0,"matStepperIcon","name"]},standalone:!0});let i=n;return i})(),Sn=(()=>{let n=class n{constructor(t){this._template=t}};n.\u0275fac=function(e){return new(e||n)(h(Q))},n.\u0275dir=j({type:n,selectors:[["ng-template","matStepContent",""]],standalone:!0});let i=n;return i})(),Ce=(()=>{let n=class n extends Gt{constructor(t,e,r,a){super(t,a),this._errorStateMatcher=e,this._viewContainerRef=r,this._isSelected=ye.EMPTY,this.stepLabel=void 0}ngAfterContentInit(){this._isSelected=this._stepper.steps.changes.pipe(we(()=>this._stepper.selectionChange.pipe(Te(t=>t.selectedStep===this),Y(this._stepper.selected===this)))).subscribe(t=>{t&&this._lazyContent&&!this._portal&&(this._portal=new di(this._lazyContent._template,this._viewContainerRef))})}ngOnDestroy(){this._isSelected.unsubscribe()}isErrorState(t,e){let r=this._errorStateMatcher.isErrorState(t,e),a=!!(t&&t.invalid&&this.interacted);return r||a}};n.\u0275fac=function(e){return new(e||n)(h(bt(()=>Yt)),h(vt,4),h(ze),h(_e,8))},n.\u0275cmp=C({type:n,selectors:[["mat-step"]],contentQueries:function(e,r,a){if(e&1&&(L(a,Ct,5),L(a,Sn,5)),e&2){let m;E(m=P())&&(r.stepLabel=m.first),E(m=P())&&(r._lazyContent=m.first)}},hostAttrs:["hidden",""],inputs:{color:"color"},exportAs:["matStep"],standalone:!0,features:[ut([{provide:vt,useExisting:n},{provide:Gt,useExisting:n}]),ct,b],ngContentSelectors:Pi,decls:1,vars:0,consts:[[3,"cdkPortalOutlet"]],template:function(e,r){e&1&&(mt(),f(0,cn,2,1,"ng-template"))},dependencies:[mi],encapsulation:2,changeDetection:0});let i=n;return i})(),Yt=(()=>{let n=class n extends Kt{get animationDuration(){return this._animationDuration}set animationDuration(t){this._animationDuration=/^\d+$/.test(t)?t+"ms":t}constructor(t,e,r){super(t,e,r),this._stepHeader=void 0,this._steps=void 0,this.steps=new pt,this.animationDone=new Z,this.labelPosition="end",this.headerPosition="top",this._iconOverrides={},this._animationDone=new st,this._animationDuration="",this._isServer=!u(qe).isBrowser;let a=r.nativeElement.nodeName.toLowerCase();this.orientation=a==="mat-vertical-stepper"?"vertical":"horizontal"}ngAfterContentInit(){super.ngAfterContentInit(),this._icons.forEach(({name:t,templateRef:e})=>this._iconOverrides[t]=e),this.steps.changes.pipe($(this._destroyed)).subscribe(()=>{this._stateChanged()}),this._animationDone.pipe(De((t,e)=>t.fromState===e.fromState&&t.toState===e.toState),$(this._destroyed)).subscribe(t=>{t.toState==="current"&&this.animationDone.emit()})}_stepIsNavigable(t,e){return e.completed||this.selectedIndex===t||!this.linear}_getAnimationDuration(){return this.animationDuration?this.animationDuration:this.orientation==="horizontal"?Bi:Li}};n.\u0275fac=function(e){return new(e||n)(h(kt,8),h(_t),h(J))},n.\u0275cmp=C({type:n,selectors:[["mat-stepper"],["mat-vertical-stepper"],["mat-horizontal-stepper"],["","matStepper",""]],contentQueries:function(e,r,a){if(e&1&&(L(a,Ce,5),L(a,bn,5)),e&2){let m;E(m=P())&&(r._steps=m),E(m=P())&&(r._icons=m)}},viewQuery:function(e,r){if(e&1&&Dt(ve,5),e&2){let a;E(a=P())&&(r._stepHeader=a)}},hostAttrs:["role","tablist"],hostVars:11,hostBindings:function(e,r){e&2&&(dt("aria-orientation",r.orientation),V("mat-stepper-horizontal",r.orientation==="horizontal")("mat-stepper-vertical",r.orientation==="vertical")("mat-stepper-label-position-end",r.orientation==="horizontal"&&r.labelPosition=="end")("mat-stepper-label-position-bottom",r.orientation==="horizontal"&&r.labelPosition=="bottom")("mat-stepper-header-position-bottom",r.headerPosition==="bottom"))},inputs:{disableRipple:"disableRipple",color:"color",labelPosition:"labelPosition",headerPosition:"headerPosition",animationDuration:"animationDuration"},outputs:{animationDone:"animationDone"},exportAs:["matStepper","matVerticalStepper","matHorizontalStepper"],standalone:!0,features:[ut([{provide:Kt,useExisting:n}]),ct,b],ngContentSelectors:Pi,decls:5,vars:2,consts:[["stepTemplate",""],[1,"mat-horizontal-stepper-wrapper"],[1,"mat-horizontal-stepper-header-container"],[1,"mat-horizontal-content-container"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id","mat-horizontal-stepper-content-inactive"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"mat-stepper-horizontal-line"],["role","tabpanel",1,"mat-horizontal-stepper-content",3,"id"],[3,"ngTemplateOutlet"],[1,"mat-step"],[1,"mat-vertical-content-container"],["role","tabpanel",1,"mat-vertical-stepper-content",3,"id"],[1,"mat-vertical-content"],[3,"click","keydown","tabIndex","id","index","state","label","selected","active","optional","errorMessage","iconOverrides","disableRipple","color"]],template:function(e,r){if(e&1&&(mt(),f(0,dn,1,0)(1,fn,7,0,"div",1)(2,_n,2,0)(3,vn,1,23,"ng-template",null,0,Ve)),e&2){let a;_(r._isServer?0:-1),p(),_((a=r.orientation)==="horizontal"?1:a==="vertical"?2:-1)}},dependencies:[oe,ve],styles:['.mat-stepper-vertical,.mat-stepper-horizontal{display:block;font-family:var(--mat-stepper-container-text-font, var(--mat-app-body-medium-font));background:var(--mat-stepper-container-color, var(--mat-app-surface))}.mat-horizontal-stepper-header-container{white-space:nowrap;display:flex;align-items:center}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header-container{align-items:flex-start}.mat-stepper-header-position-bottom .mat-horizontal-stepper-header-container{order:1}.mat-stepper-horizontal-line{border-top-width:1px;border-top-style:solid;flex:auto;height:0;margin:0 -16px;min-width:32px;border-top-color:var(--mat-stepper-line-color, var(--mat-app-outline))}.mat-stepper-label-position-bottom .mat-stepper-horizontal-line{margin:0;min-width:0;position:relative;top:calc(calc((var(--mat-stepper-header-height) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{border-top-width:1px;border-top-style:solid;content:"";display:inline-block;height:0;position:absolute;width:calc(50% - 20px)}.mat-horizontal-stepper-header{display:flex;height:72px;overflow:hidden;align-items:center;padding:0 24px;height:var(--mat-stepper-header-height)}.mat-horizontal-stepper-header .mat-step-icon{margin-right:8px;flex:none}[dir=rtl] .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:8px}.mat-horizontal-stepper-header::before,.mat-horizontal-stepper-header::after{border-top-color:var(--mat-stepper-line-color, var(--mat-app-outline))}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{padding:calc((var(--mat-stepper-header-height) - 24px) / 2) 24px}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::before,.mat-stepper-label-position-bottom .mat-horizontal-stepper-header::after{top:calc(calc((var(--mat-stepper-header-height) - 24px) / 2) + 12px)}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header{box-sizing:border-box;flex-direction:column;height:auto}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::after,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::after{right:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:first-child)::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:not(:last-child)::before{left:0}[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:last-child::before,[dir=rtl] .mat-stepper-label-position-bottom .mat-horizontal-stepper-header:first-child::after{display:none}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-icon{margin-right:0;margin-left:0}.mat-stepper-label-position-bottom .mat-horizontal-stepper-header .mat-step-label{padding:16px 0 0 0;text-align:center;width:100%}.mat-vertical-stepper-header{display:flex;align-items:center;height:24px;padding:calc((var(--mat-stepper-header-height) - 24px) / 2) 24px}.mat-vertical-stepper-header .mat-step-icon{margin-right:12px}[dir=rtl] .mat-vertical-stepper-header .mat-step-icon{margin-right:0;margin-left:12px}.mat-horizontal-stepper-wrapper{display:flex;flex-direction:column}.mat-horizontal-stepper-content{outline:0}.mat-horizontal-stepper-content.mat-horizontal-stepper-content-inactive{height:0;overflow:hidden}.mat-horizontal-stepper-content:not(.mat-horizontal-stepper-content-inactive){visibility:inherit !important}.mat-horizontal-content-container{overflow:hidden;padding:0 24px 24px 24px}.cdk-high-contrast-active .mat-horizontal-content-container{outline:solid 1px}.mat-stepper-header-position-bottom .mat-horizontal-content-container{padding:24px 24px 0 24px}.mat-vertical-content-container{margin-left:36px;border:0;position:relative}.cdk-high-contrast-active .mat-vertical-content-container{outline:solid 1px}[dir=rtl] .mat-vertical-content-container{margin-left:0;margin-right:36px}.mat-stepper-vertical-line::before{content:"";position:absolute;left:0;border-left-width:1px;border-left-style:solid;border-left-color:var(--mat-stepper-line-color, var(--mat-app-outline));top:calc(8px - calc((var(--mat-stepper-header-height) - 24px) / 2));bottom:calc(8px - calc((var(--mat-stepper-header-height) - 24px) / 2))}[dir=rtl] .mat-stepper-vertical-line::before{left:auto;right:0}.mat-vertical-stepper-content{overflow:hidden;outline:0}.mat-vertical-stepper-content:not(.mat-vertical-stepper-content-inactive){visibility:inherit !important}.mat-vertical-content{padding:0 24px 24px 24px}.mat-step:last-child .mat-vertical-content-container{border:none}'],encapsulation:2,data:{animation:[Ei.horizontalStepTransition,Ei.verticalStepTransition]},changeDetection:0});let i=n;return i})();var Ai=(()=>{let n=class n{};n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=yt({type:n}),n.\u0275inj=Mt({providers:[xn,vt],imports:[ae,Ne,hi,ki,ti,Je,Yt,ve,ae]});let i=n;return i})();function wn(i,n){i&1&&(s(0,"div",5),M(1,"mat-spinner",7),s(2,"div",8),c(3,"Loading the trip info"),l()())}function On(i,n){if(i&1&&(s(0,"mat-icon"),c(1,"person_pin_circle"),l(),c(2),S(3,"date")),i&2){let o=d(2).$implicit;p(2),x(" ",O(3,1,o.departure,"MMMM d, HH:mm")," ")}}function kn(i,n){if(i&1&&(s(0,"mat-icon"),c(1,"location_on"),l(),c(2),S(3,"date")),i&2){let o=d(2).$implicit;p(2),x(" ",O(3,1,o.arrival,"MMMM d, HH:mm")," ")}}function En(i,n){if(i&1&&(c(0),S(1,"date")),i&2){let o=d(2).$implicit;x(" ",O(1,1,o.departure,"MMMM d, HH:mm")," ")}}function Pn(i,n){if(i&1&&(c(0),S(1,"date")),i&2){let o=d(2).$implicit;x(" ",O(1,1,o.arrival,"MMMM d, HH:mm")," ")}}function Rn(i,n){if(i&1&&c(0),i&2){let o=d(2).$implicit;x(" ",o.dwellTime," min ")}}function Fn(i,n){if(i&1&&(s(0,"div",12),c(1),M(2,"span",2),s(3,"span",13),f(4,On,4,4)(5,kn,4,4)(6,En,2,4)(7,Pn,2,4)(8,Rn,1,1),l()()),i&2){let o=d(),t=o.$implicit,e=o.$index,r=o.$count,a=ne(0),m=ne(1);p(),x(" ",t.station.city," "),p(3),_(a?4:m?5:e===0?6:e===r-1?7:8)}}function zn(i,n){if(i&1&&(s(0,"p"),c(1),S(2,"date"),l()),i&2){let o=d().$implicit;p(),x("Arrival: ",O(2,1,o.arrival,"dd/MM HH:mm"),"")}}function Bn(i,n){if(i&1&&(s(0,"p"),c(1),S(2,"date"),l()),i&2){let o=d().$implicit;p(),x("Departure: ",O(2,1,o.departure,"dd/MM HH:mm"),"")}}function Ln(i,n){if(i&1&&(wt(0)(1),s(2,"mat-step",9),f(3,Fn,9,2,"ng-template",10),s(4,"div",11),f(5,zn,3,4,"p")(6,Bn,3,4,"p"),l()()),i&2){let o=n.$implicit,t=d(2);ie(o.station.id===t.data.from),p(),ie(o.station.id===t.data.to),p(4),_(o.arrival?5:-1),p(),_(o.departure?6:-1)}}function An(i,n){if(i&1&&(s(0,"mat-stepper",6,0),T(2,Ln,7,4,"mat-step",9,B),l()),i&2){let o=d();p(2),D(o.routeData())}}var ji=(()=>{let n=class n{constructor(){this.dialogRef=u(jt),this.data=u(Vt),this.isLoading=lt(!0),this.routeData=lt([]),this.rideStore=u(Ut),this.stationStore=u(rt)}ngOnInit(){Promise.all([this.rideStore.getRide(this.data.rideId),this.stationStore.getStations()]).then(()=>{this.initRouteData(),this.isLoading.set(!1)})}initRouteData(){let t=this.rideStore.ridesEntityMap()[this.data.rideId],e=this.stationStore.stationsEntityMap(),r=t.path.map(g=>e[g]),{segments:a}=t.schedule,m=ci(r,a);this.routeData.set(m)}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=C({type:n,selectors:[["app-route-modal"]],standalone:!0,features:[b],decls:10,vars:2,consts:[["stepper",""],["mat-dialog-title","",1,"header"],[1,"spacer"],["mat-icon-button","","mat-dialog-close",""],[1,"content"],[1,"spinner-container"],["orientation","vertical"],[1,"spinner"],[1,"label"],["completed","false"],["matStepLabel",""],[1,"schedule"],[1,"step-label"],[1,"dwell"]],template:function(e,r){e&1&&(s(0,"h2",1),c(1),M(2,"span",2),s(3,"button",3)(4,"mat-icon"),c(5,"close"),l()()(),M(6,"mat-divider"),s(7,"mat-dialog-content",4),f(8,wn,4,0,"div",5)(9,An,4,0,"mat-stepper",6),l()),e&2&&(p(),x(" Route ",r.data.rideId," "),p(7),_(r.isLoading()?8:9))},dependencies:[Nt,$t,Ht,Xe,Et,Pt,nt,et,Qt,Ai,Ce,Ct,Yt],styles:["[_nghost-%COMP%]   .header[_ngcontent-%COMP%]{display:flex;align-items:center;margin-top:.5rem;margin-bottom:0}[_nghost-%COMP%]   .content[_ngcontent-%COMP%]{margin:0 1rem}[_nghost-%COMP%]   .step-label[_ngcontent-%COMP%]{display:flex;align-items:center;width:350px}@media (max-width: 1200px){[_nghost-%COMP%]   .step-label[_ngcontent-%COMP%]{width:300px}}@media (max-width: 768px){[_nghost-%COMP%]   .step-label[_ngcontent-%COMP%]{width:200px}}[_nghost-%COMP%]   .spacer[_ngcontent-%COMP%]{margin:0 auto}[_nghost-%COMP%]   .dwell[_ngcontent-%COMP%]{display:flex;align-items:center}[_nghost-%COMP%]   .spinner-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:350px;height:100%}[_nghost-%COMP%]   .spinner-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{width:30px!important}[_nghost-%COMP%]   .spinner-container[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;font-size:1.2rem;top:calc(50% - 1rem);left:50%;transform:translate(-50%)}"],changeDetection:0});let i=n;return i})();var Vi=(()=>{let n=class n{constructor(){this.dialogRef=u(jt),this.data=u(Vt)}};n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=C({type:n,selectors:[["app-order-dialog"]],standalone:!0,features:[b],decls:8,vars:6,consts:[["mat-dialog-title",""],["mat-button","","mat-dialog-close",""]],template:function(e,r){e&1&&(s(0,"h2",0),c(1,"Order completed!"),l(),s(2,"mat-dialog-content"),c(3),S(4,"date"),l(),s(5,"mat-dialog-actions")(6,"button",1),c(7,"Close"),l()()),e&2&&(p(3),je("You have booked a trip from ",r.data.from.city," to ",r.data.to.city," on ",O(4,3,r.data.departure,"MMMM d, HH:mm"),"."))},dependencies:[bi,$t,et,it,Ht,Nt],changeDetection:0});let i=n;return i})();function Vn(i,n){if(i&1&&(s(0,"p",2),c(1),s(2,"span"),c(3),S(4,"currency"),l()()),i&2){let o=n.$implicit;p(),X(" Car ",o.carId,", Seat ",o.seatNumber," "),p(2),z(gt(4,3,o.price))}}function Hn(i,n){if(i&1){let o=F();s(0,"mat-card",0)(1,"mat-card-content",1),T(2,Vn,5,5,"p",2,B),s(4,"p",3),c(5),S(6,"currency"),l()(),M(7,"mat-divider",4),s(8,"mat-card-footer",5)(9,"button",6),w("click",function(){y(o);let e=d();return I(e.onBook())}),c(10," Book seat "),l()()()}if(i&2){let o=d();p(2),D(o.bookItems()),p(3),x("Total: ",gt(6,1,o.totalPrice()),"")}}var Se=(()=>{let n=class n{constructor(t){this.snackBarService=t,this.bookItems=It.required(),this.totalPrice=R(()=>this.bookItems().reduce((e,r)=>e+r.price,0)),this.bookClick=Fe()}onBook(){if(this.bookItems().length!==1){this.snackBarService.open(Ft.SelectedTooManySeats);return}this.bookClick.emit(!0)}};n.\u0275fac=function(e){return new(e||n)(h(zt))},n.\u0275cmp=C({type:n,selectors:[["app-book-modal"]],inputs:{bookItems:[1,"bookItems"]},outputs:{bookClick:"bookClick"},standalone:!0,features:[b],decls:1,vars:1,consts:[["appearance","outlined",1,"card"],[1,"card-content"],[1,"book-item"],[1,"total"],[1,"divider"],[1,"card-footer"],["mat-flat-button","",1,"book-button",3,"click"]],template:function(e,r){e&1&&f(0,Hn,11,3,"mat-card",0),e&2&&_(r.totalPrice()?0:-1)},dependencies:[it,Si,yi,Mi,Ot,Pt],styles:["[_nghost-%COMP%]{font-weight:500}[_nghost-%COMP%]   .card-content[_ngcontent-%COMP%], [_nghost-%COMP%]   .card-footer[_ngcontent-%COMP%]{padding:1rem}[_nghost-%COMP%]   .book-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between}[_nghost-%COMP%]   .total[_ngcontent-%COMP%]{display:flex;justify-content:right}[_nghost-%COMP%]   .book-button[_ngcontent-%COMP%]{width:100%}"],changeDetection:0});let i=n;return i})();var Hi={ride:{rideId:0,path:[],carriages:[],schedule:{segments:[]}},carriages:[]};var Zt=Bt({providedIn:"root"},fi(Hi),ui(({carriages:i})=>({availableSeatsMap:R(()=>si(i())),seatScopes:R(()=>pi(i())),carriagesByTypeMap:R(()=>oi(i()))})),Lt((i,n=u(vi),o=u(Ut),t=u(rt))=>({async initStore(e){await o.getRide(e);let r=o.ridesEntityMap();r[e]&&(await n.getCarriages(),await t.getStations(),H(i,{ride:r[e]}),this.createTripCarriages())},selectedToReserved(){let r=i.carriages().map(a=>{let m=a.seats.map(g=>g.state===k.Selected?at(ot({},g),{state:k.Reserved}):g);return at(ot({},a),{seats:m})});H(i,{carriages:r})},toggleSeatState(e,r){let a=i.carriages(),g=a.find(N=>N.code===e).seats.find(N=>N.number===r);g&&(g.state=g.state===k.Available?k.Selected:k.Available,H(i,{carriages:[...a]}))},initOccupiedSeats(e){let r=i.carriages(),a=i.seatScopes(),m=r.map((g,N)=>{let{from:xt,to:Jt}=a[N],Xt=e.filter(W=>W>=xt&&W<=Jt).map(W=>W-xt+1);return at(ot({},g),{seats:ni(g,Xt)})});H(i,{carriages:m})},createTripCarriages(){let e=i.ride(),r=n.carriagesEntityMap(),a=[];for(let m=0;m<e.carriages.length;m+=1){let g=r[e.carriages[m]];a.push(at(ot({},g),{code:(m+1).toString()}))}H(i,{carriages:a})}})));function $n(i,n){if(i&1){let o=F();s(0,"mat-list-item",1)(1,"app-train-car",2),w("toggleSeat",function(e){let r=y(o).$implicit,a=d();return I(a.onToggleSeat(e,r.code))}),l()()}if(i&2){let o=n.$implicit;p(),Ae("title","Carriage ",o.code,""),v("carriage",o)}}var Me=(()=>{let n=class n{constructor(t){this.trainCarService=t,this.carriages=It.required(),this.tripStore=u(Zt),this.availableCarriages=R(()=>this.carriages().filter(e=>!!this.trainCarService.getAvailableSeatsNumber(e)))}onToggleSeat(t,e){this.tripStore.toggleSeatState(e,t)}};n.\u0275fac=function(e){return new(e||n)(h(qt))},n.\u0275cmp=C({type:n,selectors:[["app-carriage-list"]],inputs:{carriages:[1,"carriages"]},standalone:!0,features:[ut([qt]),b],decls:3,vars:0,consts:[["role","list"],["role","listitem",1,"carriage"],[3,"toggleSeat","carriage","title"]],template:function(e,r){e&1&&(s(0,"mat-list",0),T(1,$n,2,3,"mat-list-item",1,B),l()),e&2&&(p(),D(r.availableCarriages()))},dependencies:[ei,Rt,Oi],styles:["[_nghost-%COMP%]   .carriage[_ngcontent-%COMP%]{height:100%;margin:2rem 0}"],changeDetection:0});let i=n;return i})();var Ni=(()=>{let n=class n{constructor(){this.rideSegments=[],this.fromStation={},this.toStation={},this.tripStore=u(Zt),this.stationStore=u(rt),this.orderStore=u(At)}async initStore(t,e,r){await this.tripStore.initStore(t),await this.orderStore.getOrders(),this.initRideSegments(e,r),this.tripStore.initOccupiedSeats(this.getOccupiedSeats()),this.initEdgeStations(e,r)}getTripView(){return R(()=>{let t=this.tripStore.ride(),e=this.getTrainClasses(),r=this.rideSegments.slice(-1)[0];return{rideId:t.rideId,from:this.fromStation,to:this.toStation,departure:this.rideSegments[0].time[0],arrival:r.time[1],trainClasses:e}})}getBookItems(){return R(()=>{let t=this.tripStore.carriages(),e=[];return t.forEach(r=>{r.seats.filter(m=>m.state===k.Selected).forEach(m=>{e.push({carId:r.code,seatNumber:m.number,price:this.priceMap[r.name]})})}),e})}async createOrder(t){let e=this.getTripView()(),{rideId:r}=e,a=e.from.id,m=e.to.id,g=this.tripStore.carriages(),N=t.map(async xt=>{let{seatNumber:Jt,carId:Xt}=xt,W=g.findIndex(Qi=>Qi.code===Xt),$i=li(g,W,Jt);return this.orderStore.createOrder(r,$i,a,m)});await Promise.all(N),this.tripStore.selectedToReserved()}get segments(){return this.rideSegments}getTrainClasses(){let t=this.tripStore.carriagesByTypeMap(),e=this.tripStore.availableSeatsMap();return Object.entries(t).map(([r,a])=>{let m=this.priceMap[r],g=e[r];return{name:r,carriages:a,price:m,availableSeats:g}})}getOccupiedSeats(){let t=new Set;return this.rideSegments.forEach(e=>{e.occupiedSeats?.forEach(r=>{t.add(r)})}),Array.from(t.values())}initRideSegments(t,e){let r=this.tripStore.ride();this.rideSegments=ai(r,t,e)}initEdgeStations(t,e){let r=this.stationStore.stationsEntityMap();this.fromStation=r[t],this.toStation=r[e]}get priceMap(){return ri(this.rideSegments)}};n.\u0275fac=function(e){return new(e||n)},n.\u0275prov=St({token:n,factory:n.\u0275fac,providedIn:"root"});let i=n;return i})();function Un(i,n){i&1&&(s(0,"div",0),M(1,"mat-spinner",1),s(2,"div",2),c(3,"Loading the trip"),l()())}function Gn(i,n){if(i&1&&(s(0,"mat-list-item")(1,"p",19),c(2),l(),s(3,"p",20),c(4),S(5,"currency"),l()()),i&2){let o=d().$implicit;p(2),X(" Carriage type ",o.name,": ",o.availableSeats," "),p(2),x(" ",gt(5,3,o.price)," ")}}function Kn(i,n){if(i&1&&(s(0,"mat-tab"),f(1,Gn,6,5,"ng-template",17),M(2,"app-carriage-list",18),l()),i&2){let o=n.$implicit;p(2),v("carriages",o.carriages)}}function Wn(i,n){if(i&1&&(s(0,"div",16),M(1,"app-car-seat",21),c(2),l()),i&2){let o=n.$implicit;p(),v("seat",o.seat)("direction","right"),p(),x(" ",o.description," ")}}function Yn(i,n){if(i&1){let o=F();wt(0),s(1,"div",3)(2,"div",4)(3,"button",5),w("click",function(){y(o);let e=d();return I(e.onBack())}),s(4,"mat-icon"),c(5,"arrow_back"),l()()(),s(6,"div",6)(7,"div",7)(8,"div",8)(9,"mat-icon"),c(10,"directions_subway"),l(),c(11),l(),s(12,"p"),c(13),S(14,"date"),S(15,"date"),l()(),s(16,"p")(17,"span"),c(18),l(),s(19,"button",9),w("click",function(){y(o);let e=d();return I(e.onRoute())}),s(20,"mat-icon"),c(21,"keyboard_arrow_down"),l(),c(22," Route "),l()()()(),s(23,"div",10)(24,"div",11)(25,"mat-tab-group",12),T(26,Kn,3,1,"mat-tab",null,B),l()(),s(28,"div",13)(29,"app-book-modal",14),w("bookClick",function(){y(o);let e=d();return I(e.onBook())}),l()(),s(30,"div",15),T(31,Wn,3,3,"div",16,B),l()()}if(i&2){let o=d(),t=o.tripView();p(11),X(" ",t.from.city," \u21D2 ",t.to.city," "),p(2),X(" ",O(14,6,t.departure,"MMMM d, HH:mm")," \u21D2 ",O(15,9,t.arrival,"MMMM d, HH:mm")," "),p(5),x("Ride ",o.tripView().rideId,""),p(8),D(t.trainClasses),p(3),v("bookItems",o.bookItems()),p(2),D(o.legendSeats)}}var _a=(()=>{let n=class n{constructor(t,e,r,a){this.router=t,this.activatedRoute=e,this.snackBarService=r,this.tripService=a,this.isLoading=lt(!0),this.dialog=u(xi),this.orderStore=u(At)}ngOnInit(){let t=Number(this.activatedRoute.snapshot.paramMap.get("rideId")),e=Number(this.activatedRoute.snapshot.queryParams.from),r=Number(this.activatedRoute.snapshot.queryParams.to);if(!t||!e||!r){this.router.navigate(["/404"]);return}this.bookItems=this.tripService.getBookItems(),this.initTripView(t,e,r)}onBook(){let{rideId:t}=this.tripView();if(this.orderStore.hasOrder(t)){this.snackBarService.open(Ft.AlreadyBooked);return}this.tripService.createOrder(this.bookItems()).then(()=>{this.dialog.open(Vi,{data:this.tripView()})}).catch(e=>this.snackBarService.displayError(e))}onBack(){this.router.navigate([ii.Search])}onRoute(){this.dialog.open(ji,{data:{rideId:this.tripView().rideId,from:this.tripView().from.id,to:this.tripView().to.id}})}get legendSeats(){return[{description:"Reserved seat",seat:{number:1,state:k.Reserved}},{description:"Avilable seat",seat:{number:1,state:k.Available}},{description:"Selected seat",seat:{number:1,state:k.Selected}}]}async initTripView(t,e,r){if(this.isLoading.set(!0),await this.tripService.initStore(t,e,r),!(this.tripService.segments.length>0)){this.router.navigate(["/404"]);return}this.tripView=this.tripService.getTripView(),this.isLoading.set(!1)}};n.\u0275fac=function(e){return new(e||n)(h(Qe),h($e),h(zt),h(Ni))},n.\u0275cmp=C({type:n,selectors:[["app-trip"]],standalone:!0,features:[b],decls:2,vars:1,consts:[[1,"spinner-container"],[1,"spinner"],[1,"label"],[1,"head"],[1,"head-back"],["mat-icon-button","",3,"click"],[1,"head-info"],[1,"head-stations"],[1,"head-cities"],["mat-button","",3,"click"],[1,"body"],[1,"carriages"],["animationDuration","0ms","mat-stretch-tabs","false","mat-align-tabs","start"],[1,"book-modal"],[3,"bookClick","bookItems"],[1,"legend"],[1,"legend-item"],["mat-tab-label",""],[3,"carriages"],["matListItemTitle",""],["matListItemLine",""],[3,"seat","direction"]],template:function(e,r){e&1&&f(0,Un,4,0,"div",0)(1,Yn,33,12),e&2&&_(r.isLoading()?0:1)},dependencies:[he,et,Me,wi,Ii,Ti,Di,Se,nt,Rt,Ot,Et,it,Qt],styles:["[_nghost-%COMP%]   .head[_ngcontent-%COMP%]{background-color:#f2f2f2;padding:1rem 5rem;font-weight:500;display:flex}@media (max-width: 768px){[_nghost-%COMP%]   .head[_ngcontent-%COMP%]{padding:.5rem}}[_nghost-%COMP%]   .head[_ngcontent-%COMP%]   .head-info[_ngcontent-%COMP%]{width:100%}[_nghost-%COMP%]   .head[_ngcontent-%COMP%]   .head-info[_ngcontent-%COMP%]   .head-stations[_ngcontent-%COMP%]{display:flex;flex-direction:row;justify-content:space-between;font-size:1.2rem}[_nghost-%COMP%]   .head[_ngcontent-%COMP%]   .head-info[_ngcontent-%COMP%]   .head-stations[_ngcontent-%COMP%]   .head-cities[_ngcontent-%COMP%]{display:flex;align-items:center}[_nghost-%COMP%]   .body[_ngcontent-%COMP%]{margin-top:1rem;padding:0 5rem 5rem}@media (max-width: 768px){[_nghost-%COMP%]   .body[_ngcontent-%COMP%]{padding:0}}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]{display:flex;justify-content:center}[_nghost-%COMP%]   .legend[_ngcontent-%COMP%]   .legend-item[_ngcontent-%COMP%]{margin-right:2rem}[_nghost-%COMP%]   .book-modal[_ngcontent-%COMP%]{width:20rem}@media (max-width: 1199px){[_nghost-%COMP%]   .book-modal[_ngcontent-%COMP%]{margin:0 auto}}@media (min-width: 1200px){[_nghost-%COMP%]   .book-modal[_ngcontent-%COMP%]{position:fixed;z-index:1;top:70%;right:4rem;transform:translateY(-50%)}}[_nghost-%COMP%]   .spinner-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;position:fixed;top:0;left:0}[_nghost-%COMP%]   .spinner-container[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}[_nghost-%COMP%]   .spinner-container[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{position:absolute;font-size:1.5rem;top:calc(50% - 6rem);left:50%;transform:translate(-50%)}"],changeDetection:0});let i=n;return i})();export{_a as TripComponent};
