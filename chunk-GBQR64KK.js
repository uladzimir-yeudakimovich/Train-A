import{a as se}from"./chunk-75FKSBTX.js";import{a as ce,b as le}from"./chunk-IY4QER5N.js";import{a as ae,b as oe,g as me}from"./chunk-D3ZEJMDG.js";import{c as L}from"./chunk-HTZT4UGI.js";import{a as R}from"./chunk-NDNJYYJX.js";import{a as A}from"./chunk-TF6AOZTO.js";import"./chunk-4T44NYJG.js";import{a as ne}from"./chunk-FPTRVRTR.js";import"./chunk-BNUCCXS7.js";import{b as ie,c as I}from"./chunk-F4STTNID.js";import{a as v}from"./chunk-EVOHVUKJ.js";import{a as re}from"./chunk-F5E23MD5.js";import"./chunk-BOSFDDH7.js";import{A as Z,C as ee,E as te,d as G,l as H,n as C,p as z,q as J,u as K,v as Q,w as W,y as X,z as Y}from"./chunk-PQ4C2WEQ.js";import"./chunk-YQJCNX7A.js";import{Ab as d,Cb as g,Fa as j,Ha as V,Hb as p,Kb as $,La as q,Lb as B,Mb as o,Nb as n,Ob as u,Sb as O,Xb as _,Zb as s,a as M,b as D,fb as c,gb as F,jc as l,ka as T,lb as U,lc as k,oa as x,rb as S,vc as P,ya as h,za as b}from"./chunk-MTQVXK5S.js";function pe(e,r){e&1&&(o(0,"mat-error"),l(1,"Carriage name is required"),n())}function ue(e,r){e&1&&(o(0,"mat-error"),l(1,"Invalid number of rows"),n())}function Ce(e,r){e&1&&(o(0,"mat-error"),l(1,"Number of left seats must be between 1 and 5"),n())}function _e(e,r){e&1&&(o(0,"mat-error"),l(1,"Number of right seats must be between 1 and 5"),n())}function fe(e,r){if(e&1&&u(0,"app-train-car",7),e&2){let m=s();g("carriage",m.prototypeCarriage())}}var N=(()=>{let r=class r{constructor(i,t){this.fb=i,this.destroyRef=t,this.carriage=null,this.addCarriage=new V,this.updateCarriage=new V,this.closeForm=new V,this.prototypeCarriage=S({name:"",rows:0,leftSeats:0,rightSeats:0,code:"",seats:[]}),this.carriageForm=this.fb.group({name:["",C.required],rows:[0,[C.required,C.min(1),C.max(50)]],leftSeats:[0,[C.required,C.min(1),C.max(5)]],rightSeats:[0,[C.required,C.min(1),C.max(5)]]})}ngOnInit(){this.carriage&&(this.carriageForm.patchValue(this.carriage),this.prototypeCarriage.set(this.carriage)),this.carriageForm.valueChanges.pipe(se(this.destroyRef)).subscribe(i=>{this.carriageForm.valid&&this.prototypeCarriage.update(t=>D(M(M({},t),i),{seats:ie(M(M({},t),i))}))})}onSave(){if(this.carriageForm.valid&&!this.carriageForm.pristine){let i=M({code:this.carriage?this.carriage.code:""},this.carriageForm.value);this.carriage?this.updateCarriage.emit(i):this.addCarriage.emit(i)}}onReset(){this.carriageForm.reset()}onClose(){this.closeForm.emit()}isUpdateDisabled(){return this.carriageForm.pristine||!this.carriageForm.valid}};r.\u0275fac=function(t){return new(t||r)(F(ee),F(j))},r.\u0275cmp=x({type:r,selectors:[["app-carriage-form"]],inputs:{carriage:"carriage"},outputs:{addCarriage:"addCarriage",updateCarriage:"updateCarriage",closeForm:"closeForm"},standalone:!0,features:[P],decls:31,vars:8,consts:[[1,"carriage-card"],[1,"carriage-form",3,"ngSubmit","formGroup"],["appearance","fill",1,"form-field-container"],["matInput","","formControlName","name","placeholder","Enter carriage name"],["matInput","","type","number","formControlName","rows","min","1","max","50","placeholder","Enter number of rows"],["matInput","","type","number","formControlName","leftSeats","min","1","max","5","placeholder","Enter number of left seats"],["matInput","","type","number","formControlName","rightSeats","min","1","max","5","placeholder","Enter number of right seats"],[3,"carriage"],[1,"form-actions"],["mat-flat-button","","type","button",1,"btn","cancel-button",3,"click"],["mat-flat-button","","type","button",1,"btn","reset-button",3,"click"],["mat-flat-button","","type","submit",1,"btn",3,"disabled"]],template:function(t,a){if(t&1&&(o(0,"mat-card",0)(1,"form",1),_("ngSubmit",function(){return a.onSave()}),o(2,"mat-form-field",2)(3,"mat-label"),l(4,"Carriage Name"),n(),u(5,"input",3),d(6,pe,2,0,"mat-error"),n(),o(7,"mat-form-field",2)(8,"mat-label"),l(9,"Rows"),n(),u(10,"input",4),d(11,ue,2,0,"mat-error"),n(),o(12,"mat-form-field",2)(13,"mat-label"),l(14,"Left Seats"),n(),u(15,"input",5),d(16,Ce,2,0,"mat-error"),n(),o(17,"mat-form-field",2)(18,"mat-label"),l(19,"Right Seats"),n(),u(20,"input",6),d(21,_e,2,0,"mat-error"),n(),o(22,"div"),d(23,fe,1,1,"app-train-car",7),n(),o(24,"div",8)(25,"button",9),_("click",function(){return a.onClose()}),l(26," Cancel "),n(),o(27,"button",10),_("click",function(){return a.onReset()}),l(28," Reset "),n(),o(29,"button",11),l(30),n()()()()),t&2){let f,w,y,E;c(),g("formGroup",a.carriageForm),c(5),p((f=a.carriageForm.get("name"))!=null&&f.invalid&&((f=a.carriageForm.get("name"))!=null&&f.touched)?6:-1),c(5),p((w=a.carriageForm.get("rows"))!=null&&w.invalid&&((w=a.carriageForm.get("rows"))!=null&&w.touched)?11:-1),c(5),p((y=a.carriageForm.get("leftSeats"))!=null&&y.invalid&&((y=a.carriageForm.get("leftSeats"))!=null&&y.touched)?16:-1),c(5),p((E=a.carriageForm.get("rightSeats"))!=null&&E.invalid&&((E=a.carriageForm.get("rightSeats"))!=null&&E.touched)?21:-1),c(2),p(a.prototypeCarriage().seats.length?23:-1),c(6),g("disabled",a.isUpdateDisabled()),c(),k(" ",a.carriage?"Update":"Save"," ")}},dependencies:[me,le,ce,ae,oe,v,te,K,H,Q,z,J,Z,Y,W,X,L,R],styles:["[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]{padding:15px;background-color:#f2f2f2}[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]   .carriage-form[_ngcontent-%COMP%]{margin:0 auto}[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]   .carriage-form[_ngcontent-%COMP%]   .form-field-container[_ngcontent-%COMP%]:not(:nth-child(4)){position:relative;padding-right:1rem}[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]   .carriage-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{margin:1rem auto 0;display:flex;justify-content:space-around;max-width:500px}[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]   .carriage-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-width:25%}[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]   .carriage-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{background-color:#fad099}[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]   .carriage-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .reset-button[_ngcontent-%COMP%]{background-color:#afafaf}"]});let e=r;return e})();var he=(e,r)=>r.code;function be(e,r){if(e&1){let m=O();o(0,"h6",2),l(1),n(),o(2,"app-carriage-form",3),_("updateCarriage",function(t){h(m);let a=s(2);return b(a.updateCarriage(t))})("closeForm",function(){h(m);let t=s(2);return b(t.closeForm())}),n()}if(e&2){let m=s().$implicit;c(),k("Update ",m.name,""),c(),g("carriage",m)}}function Me(e,r){if(e&1){let m=O();o(0,"button",4),_("click",function(){h(m);let t=s().$implicit,a=s();return b(a.toggleForm(t.code))}),o(1,"mat-icon",5),l(2,"edit_square"),n(),o(3,"label",6),l(4,"Update"),n()(),u(5,"app-train-car",7)}if(e&2){let m=s().$implicit;c(5),g("carriage",m)}}function xe(e,r){if(e&1&&(o(0,"mat-card",1),d(1,be,3,2)(2,Me,6,1),n()),e&2){let m=r.$implicit,i=s();g("id",m.name),c(),p(i.selectedCarriageCode()===m.code?1:2)}}var ge=(()=>{let r=class r{constructor(i,t){this.activatedRoute=i,this.renderer=t,this.carriages=q.required(),this.selectedCarriageCode=S(null),this.store=T(I)}toggleForm(i){let t=this.selectedCarriageCode();this.selectedCarriageCode.set(t===i?null:i)}updateCarriage(i){this.store.updateCarriage(i),this.selectedCarriageCode.set(null)}closeForm(){this.selectedCarriageCode.set(null)}ngAfterViewInit(){let{fragment:i}=this.activatedRoute.snapshot,t=this.renderer.selectRootElement(`#${i}`,!0);if(!t)return;let f=t.getBoundingClientRect().top-window.innerHeight-100;window.scrollTo({top:f,behavior:"smooth"})}};r.\u0275fac=function(t){return new(t||r)(F(G),F(U))},r.\u0275cmp=x({type:r,selectors:[["app-carriage-list"]],inputs:{carriages:[1,"carriages"]},standalone:!0,features:[P],decls:3,vars:0,consts:[[1,"list"],[1,"card",3,"id"],[1,"text-center"],[3,"updateCarriage","closeForm","carriage"],["mat-raised-button","",1,"update-button",3,"click"],["id","update","aria-hidden","false","aria-label","Update route"],["for","edit"],[3,"carriage"]],template:function(t,a){t&1&&(o(0,"mat-list",0),$(1,xe,3,2,"mat-card",1,he),n()),t&2&&(c(),B(a.carriages()))},dependencies:[re,v,L,N,R,A],styles:["[_nghost-%COMP%]{display:block;width:100%}[_nghost-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;gap:2rem}[_nghost-%COMP%]   .list[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{padding:15px;background-color:#f2f2f2;width:100%}[_nghost-%COMP%]   .list[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .text-center[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   .list[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .update-button[_ngcontent-%COMP%]{position:absolute;right:1rem}[_nghost-%COMP%]   .list[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .update-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin:0}"]});let e=r;return e})();function Fe(e,r){e&1&&u(0,"app-spinner",0),e&2&&g("loadText","Loading the carriages...")}function Se(e,r){if(e&1){let m=O();o(0,"button",4),_("click",function(){h(m);let t=s(2);return b(t.isShowForm())}),l(1," Create new carriage "),n()}}function Oe(e,r){if(e&1){let m=O();o(0,"app-carriage-form",5),_("addCarriage",function(t){h(m);let a=s(2);return b(a.addCarriage(t))})("closeForm",function(){h(m);let t=s(2);return b(t.isShowForm())}),n()}}function Pe(e,r){if(e&1&&(o(0,"div",1),d(1,Se,2,0,"button",2)(2,Oe,1,0,"app-carriage-form"),n(),u(3,"app-carriage-list",3)),e&2){let m=s();c(),p(m.formVisible()?2:1),c(2),g("carriages",m.carriages())}}var st=(()=>{let r=class r{constructor(){this.formVisible=S(!1),this.carriageStore=T(I)}ngOnInit(){this.carriageStore.getCarriages(),this.carriages=this.carriageStore.carriagesEntities}isShowForm(){this.formVisible.update(i=>!i)}addCarriage(i){this.formVisible.set(!1),this.carriageStore.addCarriage(i)}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=x({type:r,selectors:[["app-carriages"]],standalone:!0,features:[P],decls:2,vars:1,consts:[[3,"loadText"],[1,"carriage-form"],["mat-flat-button","",1,"button-center"],[3,"carriages"],["mat-flat-button","",1,"button-center",3,"click"],[3,"addCarriage","closeForm"]],template:function(t,a){t&1&&d(0,Fe,1,1,"app-spinner",0)(1,Pe,4,2),t&2&&p(a.carriages().length?1:0)},dependencies:[v,N,ge,ne],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;width:85%;margin:0 auto}[_nghost-%COMP%]   .carriage-form[_ngcontent-%COMP%]{margin:1rem}[_nghost-%COMP%]   .carriage-form[_ngcontent-%COMP%]   .button-center[_ngcontent-%COMP%]{margin:0 auto}"]});let e=r;return e})();export{st as CarriagesComponent};
