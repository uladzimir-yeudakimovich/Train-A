import{a as $}from"./chunk-EMU2OSP3.js";import{a as v}from"./chunk-75FKSBTX.js";import{a as J}from"./chunk-6UHIMEQZ.js";import{a as j}from"./chunk-IY4QER5N.js";import{b as R,g as V}from"./chunk-D3ZEJMDG.js";import"./chunk-VL46BEFP.js";import{a as w}from"./chunk-TF6AOZTO.js";import"./chunk-4T44NYJG.js";import{c as Q,d as W,e as X,f as Y,g as Z}from"./chunk-SQUVXOXM.js";import{a as K}from"./chunk-BNUCCXS7.js";import"./chunk-EK67O6HC.js";import{i as T}from"./chunk-PZQC65FW.js";import"./chunk-F4STTNID.js";import{a as P,c as G,d as A}from"./chunk-EVOHVUKJ.js";import{a as H}from"./chunk-ZWL73D3D.js";import{D as N,E as U,f as z,l as y,n as _,p as I,q as E,u as F,w as O,y as D}from"./chunk-PQ4C2WEQ.js";import"./chunk-YQJCNX7A.js";import{Ab as p,Cb as f,Fa as b,Hb as c,Mb as e,Nb as i,Ob as h,Sb as q,Xb as g,Zb as u,fb as a,gb as d,jc as r,kc as C,oa as M,rb as L,vc as S,ya as k,za as B}from"./chunk-MTQVXK5S.js";function at(t,n){t&1&&(e(0,"mat-error"),r(1,"required"),i())}function lt(t,n){t&1&&(e(0,"mat-error"),r(1,"at least 8 characters"),i())}var tt=(()=>{let n=class n{constructor(m,o,s){this.profileService=m,this.formBuilder=o,this.destroyRef=s,this.passwordForm=this.formBuilder.group({password:this.formBuilder.control("",[_.required,_.minLength(8),_.maxLength(255)])})}get shortPassword(){return this.passwordForm.controls.password.errors?.minlength}get emptyPassword(){return this.passwordForm.controls.password.errors?.required}onSubmit(){this.passwordForm.valid&&this.profileService.updateUserPassword(this.passwordForm.getRawValue()).pipe(v(this.destroyRef)).subscribe()}};n.\u0275fac=function(o){return new(o||n)(d(T),d(N),d(b))},n.\u0275cmp=M({type:n,selectors:[["app-change-password-form"]],standalone:!0,features:[S],decls:18,vars:4,consts:[[1,"dialog-header"],["mat-dialog-title",""],["mat-icon-button","","mat-dialog-close",""],[3,"ngSubmit","formGroup"],[1,"label"],["appearance","outline",1,"full-width"],["type","password","matInput","","formControlName","password",1,"full-width"],["type","submit","mat-flat-button","","mat-dialog-close","",1,"btn",3,"disabled"]],template:function(o,s){o&1&&(e(0,"div",0)(1,"div",1),r(2,"Change password"),i(),e(3,"mat-dialog-actions")(4,"button",2)(5,"mat-icon"),r(6,"close"),i()()()(),e(7,"mat-dialog-content")(8,"form",3),g("ngSubmit",function(){return s.onSubmit()}),e(9,"div",4),r(10,"New password"),i(),e(11,"mat-form-field",5),h(12,"input",6),p(13,at,2,0,"mat-error")(14,lt,2,0,"mat-error"),i(),e(15,"mat-dialog-actions")(16,"button",7),r(17," Save "),i()()()()),o&2&&(a(8),f("formGroup",s.passwordForm),a(5),c(s.emptyPassword?13:-1),a(),c(s.shortPassword?14:-1),a(2),f("disabled",s.passwordForm.invalid))},dependencies:[U,F,y,I,E,O,D,P,w,Z,X,Y,V,j,W,A,R],styles:[".dialog-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.btn[_ngcontent-%COMP%]{width:100%;border-radius:4px}.label[_ngcontent-%COMP%]{font-weight:700;margin-bottom:10px}.full-width[_ngcontent-%COMP%]{width:100%}"],changeDetection:0});let t=n;return t})();function mt(t,n){t&1&&h(0,"mat-progress-spinner",6)}function st(t,n){if(t&1&&(e(0,"div"),r(1),i()),t&2){let l=u(2);a(),C(l.userInformationForm.value.name)}}function dt(t,n){t&1&&(e(0,"mat-error"),r(1,"required"),i())}function ct(t,n){if(t&1&&(e(0,"div")(1,"mat-form-field",12),h(2,"input",13),p(3,dt,2,0,"mat-error"),i()()),t&2){let l=u(2);a(3),c(l.invalidName?3:-1)}}function pt(t,n){if(t&1&&(e(0,"div"),r(1),i()),t&2){let l=u(2);a(),C(l.userInformationForm.value.email)}}function ut(t,n){t&1&&(e(0,"mat-error"),r(1,"required"),i())}function ft(t,n){t&1&&(e(0,"mat-error"),r(1,"invalid email"),i())}function gt(t,n){if(t&1&&(e(0,"div")(1,"mat-form-field",12),h(2,"input",14),p(3,ut,2,0,"mat-error")(4,ft,2,0,"mat-error"),i()()),t&2){let l=u(2);a(3),c(l.emptyEmail?3:-1),a(),c(l.invalidEmail?4:-1)}}function _t(t,n){if(t&1){let l=q();e(0,"div",8)(1,"div",9),r(2,"Name"),i(),e(3,"div",10),p(4,st,2,1,"div")(5,ct,4,1,"div"),e(6,"button",11),g("click",function(){k(l);let o=u();return B(o.editMode().name?o.onSubmit():o.toggleEditMode("name"))}),e(7,"mat-icon"),r(8),i()()()(),e(9,"div",8)(10,"div",9),r(11,"Email"),i(),e(12,"div",10),p(13,pt,2,1,"div")(14,gt,5,2,"div"),e(15,"button",11),g("click",function(){k(l);let o=u();return B(o.editMode().email?o.onSubmit():o.toggleEditMode("email"))}),e(16,"mat-icon"),r(17),i()()()()}if(t&2){let l=u();a(4),c(l.editMode().name?5:4),a(2),f("disabled",l.invalidName),a(2),C(l.editMode().name?"save":"edit"),a(5),c(l.editMode().email?14:13),a(2),f("disabled",l.invalidEmail||l.emptyEmail),a(2),C(l.editMode().email?"save":"edit")}}var Lt=(()=>{let n=class n{constructor(m,o,s,x,et,it){this.router=m,this.profileService=o,this.authService=s,this.formBuilder=x,this.matDialog=et,this.destroyRef=it,this.loading=L(!1),this.userInformationForm=this.formBuilder.group({email:this.formBuilder.control("",[_.required,$()]),name:this.formBuilder.control("",[_.required])}),this.editMode=L({email:!1,name:!1}),this.userRole=this.profileService.userRole}ngOnInit(){this.getUserInformation()}get invalidEmail(){return this.userInformationForm.controls.email.errors?.invalidEmail}get emptyEmail(){return this.userInformationForm.controls.email.errors?.required}get invalidName(){return this.userInformationForm.controls.name.errors?.required}toggleEditMode(m){this.editMode()[m]=!this.editMode()[m]}onSubmit(){this.editMode.set({email:!1,name:!1}),this.updateUserInformation()}logout(){this.authService.logout(),this.profileService.userRole.set("user"),this.router.navigate([H.Search])}openDialog(){this.matDialog.open(tt)}getUserInformation(){this.setLoading(!0),this.profileService.getUserInformation().pipe(v(this.destroyRef)).subscribe({next:m=>{this.userInformationForm.setValue({name:m.name??"Name Surname",email:m.email})},error:()=>{this.setLoading(!1)},complete:()=>{this.setLoading(!1)}})}updateUserInformation(){this.setLoading(!0);let m=this.userInformationForm.getRawValue();this.profileService.updateUserInformation(m).pipe(v(this.destroyRef)).subscribe({error:()=>{this.setLoading(!1)},complete:()=>{this.setLoading(!1)}})}setLoading(m){this.loading.set(m)}};n.\u0275fac=function(o){return new(o||n)(d(z),d(T),d(J),d(N),d(Q),d(b))},n.\u0275cmp=M({type:n,selectors:[["app-user-profile"]],standalone:!0,features:[S],decls:13,vars:3,consts:[[1,"layout"],[1,"title"],[1,"role-and-button"],[1,"role"],["mat-flat-button","",1,"btn",3,"click"],[1,"form",3,"formGroup"],["mode","indeterminate",1,"spinner"],["mat-flat-button","","color","warn",1,"btn","btn-logout",3,"click"],[1,"control"],[1,"label"],[1,"input-and-buton"],["mat-mini-fab","",3,"click","disabled"],["appearance","outline","subscriptSizing","dynamic",1,"full-width"],["type","text","matInput","","formControlName","name"],["type","email","matInput","","formControlName","email"]],template:function(o,s){o&1&&(e(0,"div",0)(1,"h4",1),r(2,"Profile"),i(),e(3,"div",2)(4,"div",3),r(5),i(),e(6,"button",4),g("click",function(){return s.openDialog()}),r(7,"Change Password"),i()(),e(8,"form",5),p(9,mt,1,0,"mat-progress-spinner",6)(10,_t,18,6),i(),e(11,"button",7),g("click",function(){return s.logout()}),r(12,"Logout"),i()()),o&2&&(a(5),C(s.userRole()==="manager"?"manager":""),a(3),f("formGroup",s.userInformationForm),a(),c(s.loading()?9:10))},dependencies:[U,F,y,I,E,O,D,w,G,V,j,K,P,R],styles:["[_nghost-%COMP%]   .layout[_ngcontent-%COMP%]{display:grid;gap:30px;width:450px;margin:40px auto;padding:20px;background-color:#f2f2f2;border-radius:12px}@media (max-width: 576px){[_nghost-%COMP%]   .layout[_ngcontent-%COMP%]{width:80%}}[_nghost-%COMP%]   .layout[_ngcontent-%COMP%]   .title[_ngcontent-%COMP%]{text-align:center;font-weight:900}[_nghost-%COMP%]   .role-and-button[_ngcontent-%COMP%]{justify-self:end;text-align:right}[_nghost-%COMP%]   .role[_ngcontent-%COMP%]{text-transform:capitalize;padding-right:10px}[_nghost-%COMP%]   .btn[_ngcontent-%COMP%]{border-radius:4px}[_nghost-%COMP%]   .btn-logout[_ngcontent-%COMP%]{justify-self:start}[_nghost-%COMP%]   .form[_ngcontent-%COMP%]{display:grid;gap:10px}[_nghost-%COMP%]   .spinner[_ngcontent-%COMP%]{justify-self:center}[_nghost-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:700}[_nghost-%COMP%]   .input-and-buton[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:20px;align-items:center}[_nghost-%COMP%]   .full-width[_ngcontent-%COMP%], [_nghost-%COMP%]   .ng-star-inserted[_ngcontent-%COMP%]{width:100%}"],changeDetection:0});let t=n;return t})();export{Lt as UserProfileComponent};
