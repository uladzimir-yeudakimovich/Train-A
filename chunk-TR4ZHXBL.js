import{a as he}from"./chunk-TF6AOZTO.js";import{a as Et}from"./chunk-W37UTC3R.js";import{a as xe}from"./chunk-XUEP42PT.js";import{a as It}from"./chunk-FPTRVRTR.js";import{c as Tt}from"./chunk-SQUVXOXM.js";import"./chunk-BNUCCXS7.js";import{A as vt,B as Ct,Q as bt,S as F,T as yt,V as wt,W as St,a as Q,c as ut,d as ht,f as ie,j as Te,k as Ee,n as ne,o as ae,q as Me,x as _t}from"./chunk-EVOHVUKJ.js";import{a as te}from"./chunk-ZWL73D3D.js";import{E as ft,d as gt,f as xt}from"./chunk-PQ4C2WEQ.js";import{Ga as ge,L as lt,_ as ct,d as rt,da as pt,ka as mt,p as st,x as dt}from"./chunk-YQJCNX7A.js";import{$b as $,Aa as Be,Ab as C,Bb as Ce,Bc as Ie,Ca as Le,Cb as v,Da as ze,Db as Ye,Eb as Z,F as Oe,G as Y,Ha as R,Hb as b,I as G,Ib as T,Kb as E,La as ce,Lb as M,M as $e,Ma as Qe,Mb as s,Na as qe,Nb as d,Nc as ee,Ob as O,Rc as j,Sa as _e,Sb as f,Sc as ot,Tc as A,Xb as u,Y as fe,Z as je,Zb as l,_b as be,a as U,b as K,bc as ye,cc as Ge,dc as me,ea as Ne,ec as ue,fa as se,fb as c,g as re,gb as x,gc as Ze,ha as B,hc as Je,ib as Ue,ic as w,ja as He,jc as p,ka as _,kc as L,l as W,lc as D,mc as we,o as ke,oa as S,oc as et,pa as de,pb as Ke,pc as tt,qa as k,qc as it,r as Ve,rb as pe,rc as nt,s as X,sb as We,sc as at,tc as J,ub as Xe,uc as z,vb as ve,vc as I,xa as le,xb as V,ya as h,za as g,zc as Se}from"./chunk-MTQVXK5S.js";var Qt=n=>n.map(i=>({time:{departure:{date:i.time[0].split("T")[0],time:i.time[0].split("T")[1].slice(0,5)},arrival:{date:i.time[1].split("T")[0],time:i.time[1].split("T")[1].slice(0,5)}},price:i.price})),De=n=>n.map(i=>({time:[new Date(`${i.time.departure.date}T${i.time.departure.time}`).toISOString(),new Date(`${i.time.arrival.date}T${i.time.arrival.time}`).toISOString()],price:i.price})),Mt=n=>n.map(i=>({rideId:i.rideId,segments:Qt(i.segments)}));var Dt=(()=>{let i=class i{constructor(t){this.http=t,this.stationsStore=_(xe)}getRouteInformation(t){return this.http.get(`${ie.Route}/${t}`).pipe(je(e=>{let a=[...new Set(e.carriages)],r=this.stationsStore.getStationsByIds()(e.path).map(y=>y.city),m=Mt(e.schedule);return Ve({routeId:e.id,carriages:a,stations:r,schedule:m})}),G(e=>X(()=>e)))}createRide(t,e){let a=De(e);return this.http.post(`${ie.Route}/${t}/ride`,{segments:a}).pipe(G(r=>X(()=>r)))}updateRide(t,e,a){let r=De(a);return this.http.put(`${ie.Route}/${t}/ride/${e}`,{segments:r}).pipe(G(m=>X(()=>m)))}deleteRide(t,e){return this.http.delete(`${ie.Route}/${t}/ride/${e}`).pipe(G(a=>X(()=>a)))}};i.\u0275fac=function(e){return new(e||i)(He(dt))},i.\u0275prov=Ne({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();var qt={routeId:0,carriages:[],stations:[],schedule:[],loading:!1},P=yt({providedIn:"root"},St(qt),wt((n,i=_(Dt),o=_(bt))=>({prepareStore(t){F(n,{loading:!0}),i.getRouteInformation(t).subscribe({next:e=>{F(n,{routeId:e.routeId,carriages:e.carriages,stations:e.stations,schedule:e.schedule})},error:e=>{o.displayError(e),F(n,{loading:!1})},complete:()=>{F(n,{loading:!1})}})},updateRide(t){let e=n.schedule().find(a=>a.rideId===t);e&&i.updateRide(n.routeId(),t,e.segments).subscribe({error:a=>{o.displayError(a)}})},createRide(t,e){F(n,{loading:!0}),i.createRide(t,e).subscribe({next(a){let r={rideId:a.id,segments:e};F(n,m=>K(U({},m),{schedule:[r,...m.schedule],loading:!1}))},error:a=>{o.displayError(a)},complete:()=>{F(n,{loading:!1})}})},deleteRide(t){i.deleteRide(n.routeId(),t).subscribe({next(){F(n,e=>K(U({},e),{schedule:e.schedule.filter(a=>a.rideId!==t)}))},error:e=>{o.displayError(e)}})}})));function Ut(n,i){if(n&1&&(s(0,"p"),p(1),d()),n&2){let o=i.$implicit;c(),L(o)}}function Kt(n,i){if(n&1){let o=f();s(0,"div",17)(1,"div"),p(2),d(),s(3,"input",18,4),u("change",function(){let e=h(o).$implicit,a=w(4),r=l().$index,m=l(2);return g(m.onPriceChange(r,e,a.value))}),d()()}if(n&2){let o=i.$implicit;c(2),L(o)}}function Wt(n,i){if(n&1){let o=f();s(0,"div",9)(1,"div",13)(2,"div"),p(3," Departure: "),s(4,"input",14,0),u("change",function(){let e=h(o).$index,a=w(5),r=l(2);return g(r.onDepartureDateChange(e,a.value))}),d(),s(6,"input",15,1),u("change",function(){let e=h(o).$index,a=w(7),r=l(2);return g(r.onDepartureTimeChange(e,a.value))}),d()(),s(8,"div"),p(9," Arrival: "),s(10,"input",14,2),u("change",function(){let e=h(o).$index,a=w(11),r=l(2);return g(r.onArrivalDateChange(e,a.value))}),d(),s(12,"input",15,3),u("change",function(){let e=h(o).$index,a=w(13),r=l(2);return g(r.onArrivalTimeChange(e,a.value))}),d()()(),s(14,"div",16),E(15,Kt,5,1,"div",17,T),d()()}if(n&2){let o=l(2);c(15),M(o.carriageTypes())}}function Xt(n,i){if(n&1){let o=f();s(0,"div",5)(1,"h3"),p(2,"Create Ride"),d(),s(3,"div",6)(4,"div",7),E(5,Ut,2,1,"p",null,T),d(),s(7,"div",8),E(8,Wt,17,0,"div",9,T),d()(),s(10,"div",10)(11,"button",11),u("click",function(){h(o);let e=l();return g(e.onCancelButtonClick())}),p(12," Cancel "),d(),s(13,"button",12),u("click",function(){h(o);let e=l();return g(e.onCreateButtonClick())}),p(14," Create "),d()()()}if(n&2){let o=l();c(5),M(o.stations()),c(3),M(o.rideSegments()),c(5),v("disabled",!o.areAllFieldsFilled())}}var Ft=(()=>{let i=class i{constructor(){this.ridesStore=_(P),this.stations=A(()=>this.ridesStore.stations()),this.rideSegments=A(()=>this.ridesStore.stations()),this.carriageTypes=A(()=>this.ridesStore.carriages()),this.segmentsForSubmit=A(()=>this.rideSegments().map(()=>{let t={};return this.carriageTypes().forEach(e=>{t[e]=0}),{time:{departure:{date:"",time:"12:00"},arrival:{date:"",time:"12:00"}},price:t}})),this.formVisible=Xe(!1)}onDepartureDateChange(t,e){this.segmentsForSubmit()[t].time.departure.date=e}onDepartureTimeChange(t,e){this.segmentsForSubmit()[t].time.departure.time=e}onArrivalDateChange(t,e){this.segmentsForSubmit()[t].time.arrival.date=e}onArrivalTimeChange(t,e){this.segmentsForSubmit()[t].time.arrival.time=e}onPriceChange(t,e,a){this.segmentsForSubmit()[t].price[e]=Number(a)}onCreateButtonClick(){this.formVisible.set(!1),this.ridesStore.createRide(this.ridesStore.routeId(),this.segmentsForSubmit())}areAllFieldsFilled(){return this.segmentsForSubmit().every(t=>t.time.departure.date&&t.time.departure.time&&t.time.arrival.date&&t.time.arrival.time)}onCancelButtonClick(){this.formVisible.set(!1)}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=S({type:i,selectors:[["app-ride-card-form"]],inputs:{formVisible:[1,"formVisible"]},outputs:{formVisible:"formVisibleChange"},standalone:!0,features:[I],decls:1,vars:1,consts:[["departureDate",""],["departureTime",""],["arrivalDate",""],["arrivalTime",""],["price",""],[1,"form-like"],[1,"container"],[1,"stations"],[1,"dates-and-prices"],[1,"row"],[1,"buttons"],["mat-flat-button","","color","warn",3,"click"],["mat-flat-button","",3,"click","disabled"],[1,"dates"],["type","date",3,"change"],["type","time",3,"change"],[1,"prices"],[1,"price"],["type","text",3,"change"]],template:function(e,a){e&1&&C(0,Xt,15,1,"div",5),e&2&&b(a.ridesStore.loading()?-1:0)},dependencies:[ft,Q],styles:[".form-like[_ngcontent-%COMP%]{display:grid;row-gap:20px;padding:10px;border:1px solid gray;border-radius:5px;margin-bottom:50px}.container[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr;column-gap:10px}.stations[_ngcontent-%COMP%]{padding-left:5px;background-color:#fff4e2;display:flex;flex-direction:column;justify-content:space-between;border-radius:4px}.row[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr;column-gap:20px}.dates[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between}.prices[_ngcontent-%COMP%]{padding-block:50px;display:grid;row-gap:5px}.price[_ngcontent-%COMP%]{display:flex;column-gap:10px}.buttons[_ngcontent-%COMP%]{justify-self:end;display:flex;column-gap:10px}"]});let n=i;return n})();var Gt=0,Fe=new B("CdkAccordion"),Rt=(()=>{let i=class i{constructor(){this._stateChanges=new W,this._openCloseAllActions=new W,this.id=`cdk-accordion-${Gt++}`,this.multi=!1}openAll(){this.multi&&this._openCloseAllActions.next(!0)}closeAll(){this._openCloseAllActions.next(!1)}ngOnChanges(t){this._stateChanges.next(t)}ngOnDestroy(){this._stateChanges.complete(),this._openCloseAllActions.complete()}};i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=k({type:i,selectors:[["cdk-accordion"],["","cdkAccordion",""]],inputs:{multi:[2,"multi","multi",j]},exportAs:["cdkAccordion"],standalone:!0,features:[z([{provide:Fe,useExisting:i}]),V,le]});let n=i;return n})(),Zt=0,At=(()=>{let i=class i{get expanded(){return this._expanded}set expanded(t){if(this._expanded!==t){if(this._expanded=t,this.expandedChange.emit(t),t){this.opened.emit();let e=this.accordion?this.accordion.id:this.id;this._expansionDispatcher.notify(this.id,e)}else this.closed.emit();this._changeDetectorRef.markForCheck()}}constructor(t,e,a){this.accordion=t,this._changeDetectorRef=e,this._expansionDispatcher=a,this._openCloseAllSubscription=re.EMPTY,this.closed=new R,this.opened=new R,this.destroyed=new R,this.expandedChange=new R,this.id=`cdk-accordion-child-${Zt++}`,this._expanded=!1,this.disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=a.listen((r,m)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===m&&this.id!==r&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(t=>{this.disabled||(this.expanded=t)})}};i.\u0275fac=function(e){return new(e||i)(x(Fe,12),x(ee),x(ge))},i.\u0275dir=k({type:i,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:[2,"expanded","expanded",j],disabled:[2,"disabled","disabled",j]},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],standalone:!0,features:[z([{provide:Fe,useValue:void 0}]),V]});let n=i;return n})(),Pt=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=de({type:i}),i.\u0275inj=se({});let n=i;return n})();var ti=["body"],ii=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],ni=["mat-expansion-panel-header","*","mat-action-row"];function ai(n,i){}var oi=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],ri=["mat-panel-title","mat-panel-description","*"];function si(n,i){if(n&1&&(s(0,"span",1),Be(),s(1,"svg",2),O(2,"path",3),d()()),n&2){let o=l();v("@indicatorRotate",o._getExpandedState())}}var Re=new B("MAT_ACCORDION"),kt="225ms cubic-bezier(0.4,0.0,0.2,1)",Ot={indicatorRotate:Te("indicatorRotate",[ae("collapsed, void",ne({transform:"rotate(0deg)"})),ae("expanded",ne({transform:"rotate(180deg)"})),Me("expanded <=> collapsed, void => collapsed",Ee(kt))]),bodyExpansion:Te("bodyExpansion",[ae("collapsed, void",ne({height:"0px",visibility:"hidden"})),ae("expanded",ne({height:"*",visibility:""})),Me("expanded <=> collapsed, void => collapsed",Ee(kt))])},$t=new B("MAT_EXPANSION_PANEL"),di=(()=>{let i=class i{constructor(t,e){this._template=t,this._expansionPanel=e}};i.\u0275fac=function(e){return new(e||i)(x(Ue),x($t,8))},i.\u0275dir=k({type:i,selectors:[["ng-template","matExpansionPanelContent",""]],standalone:!0});let n=i;return n})(),li=0,jt=new B("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS"),Ae=(()=>{let i=class i extends At{get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(t){this._hideToggle=t}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(t){this._togglePosition=t}constructor(t,e,a,r,m,y,N){super(t,e,a),this._viewContainerRef=r,this._animationMode=y,this._hideToggle=!1,this.afterExpand=new R,this.afterCollapse=new R,this._inputChanges=new W,this._headerId=`mat-expansion-panel-header-${li++}`,this.accordion=t,this._document=m,this._animationsDisabled=y==="NoopAnimations",N&&(this.hideToggle=N.hideToggle)}_hasSpacing(){return this.accordion?this.expanded&&this.accordion.displayMode==="default":!1}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe(fe(null),Y(()=>this.expanded&&!this._portal),$e(1)).subscribe(()=>{this._portal=new _t(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(t){this._inputChanges.next(t)}ngOnDestroy(){super.ngOnDestroy(),this._inputChanges.complete()}_containsFocus(){if(this._body){let t=this._document.activeElement,e=this._body.nativeElement;return t===e||e.contains(t)}return!1}_animationStarted(t){!Vt(t)&&!this._animationsDisabled&&this._body&&this._body?.nativeElement.setAttribute("inert","")}_animationDone(t){Vt(t)||(t.toState==="expanded"?this.afterExpand.emit():t.toState==="collapsed"&&this.afterCollapse.emit(),!this._animationsDisabled&&this._body&&this._body.nativeElement.removeAttribute("inert"))}};i.\u0275fac=function(e){return new(e||i)(x(Re,12),x(ee),x(ge),x(Ke),x(rt),x(_e,8),x(jt,8))},i.\u0275cmp=S({type:i,selectors:[["mat-expansion-panel"]],contentQueries:function(e,a,r){if(e&1&&ye(r,di,5),e&2){let m;me(m=ue())&&(a._lazyContent=m.first)}},viewQuery:function(e,a){if(e&1&&Ge(ti,5),e&2){let r;me(r=ue())&&(a._body=r.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(e,a){e&2&&Z("mat-expanded",a.expanded)("_mat-animation-noopable",a._animationsDisabled)("mat-expansion-panel-spacing",a._hasSpacing())},inputs:{hideToggle:[2,"hideToggle","hideToggle",j],togglePosition:"togglePosition"},outputs:{afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],standalone:!0,features:[z([{provide:Re,useValue:void 0},{provide:$t,useExisting:i}]),V,ve,le,I],ngContentSelectors:ni,decls:7,vars:4,consts:[["body",""],["role","region",1,"mat-expansion-panel-content",3,"id"],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(e,a){if(e&1){let r=f();be(ii),$(0),s(1,"div",1,0),u("@bodyExpansion.start",function(y){return h(r),g(a._animationStarted(y))})("@bodyExpansion.done",function(y){return h(r),g(a._animationDone(y))}),s(3,"div",2),$(4,1),C(5,ai,0,0,"ng-template",3),d(),$(6,2),d()}e&2&&(c(),v("@bodyExpansion",a._getExpandedState())("id",a.id),Ce("aria-labelledby",a._headerId),c(4),v("cdkPortalOutlet",a._portal))},dependencies:[vt],styles:['.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative;background:var(--mat-expansion-container-background-color, var(--mat-app-surface));color:var(--mat-expansion-container-text-color, var(--mat-app-on-surface));border-radius:var(--mat-expansion-container-shape)}.mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:var(--mat-expansion-container-shape);border-top-left-radius:var(--mat-expansion-container-shape)}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:var(--mat-expansion-container-shape);border-bottom-left-radius:var(--mat-expansion-container-shape)}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible;font-family:var(--mat-expansion-container-text-font, var(--mat-app-body-large-font));font-size:var(--mat-expansion-container-text-size, var(--mat-app-body-large-size));font-weight:var(--mat-expansion-container-text-weight, var(--mat-app-body-large-weight));line-height:var(--mat-expansion-container-text-line-height, var(--mat-app-body-large-line-height));letter-spacing:var(--mat-expansion-container-text-tracking, var(--mat-app-body-large-tracking))}.mat-expansion-panel-content[style*="visibility: hidden"] *{visibility:hidden !important}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px;border-top-color:var(--mat-expansion-actions-divider-color, var(--mat-app-outline))}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2,data:{animation:[Ot.bodyExpansion]},changeDetection:0});let n=i;return n})();function Vt(n){return n.fromState==="void"}var Pe=(()=>{let i=class i{constructor(t,e,a,r,m,y,N){this.panel=t,this._element=e,this._focusMonitor=a,this._changeDetectorRef=r,this._animationMode=y,this._parentChangeSubscription=re.EMPTY,this.tabIndex=0;let zt=t.accordion?t.accordion._stateChanges.pipe(Y(H=>!!(H.hideToggle||H.togglePosition))):ke;this.tabIndex=parseInt(N||"")||0,this._parentChangeSubscription=Oe(t.opened,t.closed,zt,t._inputChanges.pipe(Y(H=>!!(H.hideToggle||H.disabled||H.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),t.closed.pipe(Y(()=>t._containsFocus())).subscribe(()=>a.focusVia(e,"program")),m&&(this.expandedHeight=m.expandedHeight,this.collapsedHeight=m.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){let t=this._isExpanded();return t&&this.expandedHeight?this.expandedHeight:!t&&this.collapsedHeight?this.collapsedHeight:null}_keydown(t){switch(t.keyCode){case 32:case 13:lt(t)||(t.preventDefault(),this._toggle());break;default:this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(t);return}}focus(t,e){t?this._focusMonitor.focusVia(this._element,t,e):this._element.nativeElement.focus(e)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(t=>{t&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}};i.\u0275fac=function(e){return new(e||i)(x(Ae,1),x(Qe),x(pt),x(ee),x(jt,8),x(_e,8),ze("tabindex"))},i.\u0275cmp=S({type:i,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(e,a){e&1&&u("click",function(){return a._toggle()})("keydown",function(m){return a._keydown(m)}),e&2&&(Ce("id",a.panel._headerId)("tabindex",a.disabled?-1:a.tabIndex)("aria-controls",a._getPanelId())("aria-expanded",a._isExpanded())("aria-disabled",a.panel.disabled),Ye("height",a._getHeaderHeight()),Z("mat-expanded",a._isExpanded())("mat-expansion-toggle-indicator-after",a._getTogglePosition()==="after")("mat-expansion-toggle-indicator-before",a._getTogglePosition()==="before")("_mat-animation-noopable",a._animationMode==="NoopAnimations"))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight",tabIndex:[2,"tabIndex","tabIndex",t=>t==null?0:ot(t)]},standalone:!0,features:[V,I],ngContentSelectors:ri,decls:5,vars:3,consts:[[1,"mat-content"],[1,"mat-expansion-indicator"],["xmlns","http://www.w3.org/2000/svg","viewBox","0 -960 960 960","aria-hidden","true","focusable","false"],["d","M480-345 240-585l56-56 184 184 184-184 56 56-240 240Z"]],template:function(e,a){e&1&&(be(oi),s(0,"span",0),$(1),$(2,1),$(3,2),d(),C(4,si,3,1,"span",1)),e&2&&(Z("mat-content-hide-toggle",!a._showToggle()),c(4),b(a._showToggle()?4:-1))},styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-expansion-header-collapsed-state-height);font-family:var(--mat-expansion-header-text-font, var(--mat-app-title-medium-font));font-size:var(--mat-expansion-header-text-size, var(--mat-app-title-medium-size));font-weight:var(--mat-expansion-header-text-weight, var(--mat-app-title-medium-weight));line-height:var(--mat-expansion-header-text-line-height, var(--mat-app-title-medium-line-height));letter-spacing:var(--mat-expansion-header-text-tracking, var(--mat-app-title-medium-tracking))}.mat-expansion-panel-header.mat-expanded{height:var(--mat-expansion-header-expanded-state-height)}.mat-expansion-panel-header[aria-disabled=true]{color:var(--mat-expansion-header-disabled-state-text-color)}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-header-hover-state-layer-color)}@media(hover: none){.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-container-background-color, var(--mat-app-surface))}}.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-keyboard-focused,.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-program-focused{background:var(--mat-expansion-header-focus-state-layer-color)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title{color:var(--mat-expansion-header-text-color, var(--mat-app-on-surface))}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-title,.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-description{color:inherit}.mat-expansion-panel-header-description{flex-grow:2;color:var(--mat-expansion-header-description-color, var(--mat-app-on-surface-variant))}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;color:var(--mat-expansion-header-indicator-color, var(--mat-app-on-surface-variant));display:var(--mat-expansion-legacy-header-indicator-display, inline-block)}.mat-expansion-indicator svg{width:24px;height:24px;margin:0 -8px;vertical-align:middle;fill:var(--mat-expansion-header-indicator-color, var(--mat-app-on-surface-variant));display:var(--mat-expansion-header-indicator-display, none)}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}'],encapsulation:2,data:{animation:[Ot.indicatorRotate]},changeDetection:0});let n=i;return n})();var Nt=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275dir=k({type:i,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"],standalone:!0});let n=i;return n})(),oe=(()=>{let i=class i extends Rt{constructor(){super(...arguments),this._ownHeaders=new qe,this.hideToggle=!1,this.displayMode="default",this.togglePosition="after"}ngAfterContentInit(){this._headers.changes.pipe(fe(this._headers)).subscribe(t=>{this._ownHeaders.reset(t.filter(e=>e.panel.accordion===this)),this._ownHeaders.notifyOnChanges()}),this._keyManager=new ct(this._ownHeaders).withWrap().withHomeAndEnd()}_handleHeaderKeydown(t){this._keyManager.onKeydown(t)}_handleHeaderFocus(t){this._keyManager.updateActiveItem(t)}ngOnDestroy(){super.ngOnDestroy(),this._keyManager?.destroy(),this._ownHeaders.destroy()}};i.\u0275fac=(()=>{let t;return function(a){return(t||(t=Le(i)))(a||i)}})(),i.\u0275dir=k({type:i,selectors:[["mat-accordion"]],contentQueries:function(e,a,r){if(e&1&&ye(r,Pe,5),e&2){let m;me(m=ue())&&(a._headers=m)}},hostAttrs:[1,"mat-accordion"],hostVars:2,hostBindings:function(e,a){e&2&&Z("mat-accordion-multi",a.multi)},inputs:{hideToggle:[2,"hideToggle","hideToggle",j],displayMode:"displayMode",togglePosition:"togglePosition"},exportAs:["matAccordion"],standalone:!0,features:[z([{provide:Re,useExisting:i}]),V,ve]});let n=i;return n})(),Ht=(()=>{let i=class i{};i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=de({type:i}),i.\u0275inj=se({imports:[mt,Pt,Ct]});let n=i;return n})();function pi(n,i){if(n&1&&(s(0,"div",11),p(1),d()),n&2){let o=i.$implicit;c(),L(o)}}function mi(n,i){if(n&1&&(p(0),Se(1,"date")),n&2){let o=l().$implicit;we(" ",o.time.departure.date," ",Ie(1,2,o.time.departure.date+"T"+o.time.departure.time,"hh:mm a")," ")}}function ui(n,i){if(n&1){let o=f();s(0,"input",20,0),u("input",function(){h(o);let e=w(1),a=l().$index,r=l();return g(r.onDepartureDateInput(a,e.value))}),d(),s(2,"input",21,1),u("input",function(){h(o);let e=w(3),a=l().$index,r=l();return g(r.onDepartureTimeInput(a,e.value))}),d()}if(n&2){let o=l().$implicit;v("value",o.time.departure.date),c(2),v("value",o.time.departure.time)}}function hi(n,i){if(n&1&&(p(0),Se(1,"date")),n&2){let o=l().$implicit;we(" ",o.time.arrival.date," ",Ie(1,2,o.time.arrival.date+"T"+o.time.arrival.time,"hh:mm a")," ")}}function gi(n,i){if(n&1){let o=f();s(0,"input",20,2),u("input",function(){h(o);let e=w(1),a=l().$index,r=l();return g(r.onArrivalDateInput(a,e.value))}),d(),s(2,"input",21,3),u("input",function(){h(o);let e=w(3),a=l().$index,r=l();return g(r.onArrivalTimeInput(a,e.value))}),d()}if(n&2){let o=l().$implicit;v("value",o.time.arrival.date),c(2),v("value",o.time.arrival.time)}}function xi(n,i){if(n&1&&p(0),n&2){let o=l().$implicit;D(" $",o.value," ")}}function fi(n,i){if(n&1){let o=f();s(0,"input",25,4),u("input",function(){h(o);let e=w(1),a=l(),r=a.$implicit,m=a.$index,y=l().$index,N=l();return g(N.onPriceInput(y,m,r.type,e.value))}),d()}if(n&2){let o=l().$implicit;v("value",o.value)}}function _i(n,i){if(n&1&&(s(0,"div",19)(1,"div",22),p(2),d(),s(3,"div",23),C(4,xi,1,1)(5,fi,2,1,"input",24),d()()),n&2){let o=i.$implicit;l();let t=J(0);c(2),L(o.type),c(2),b(t.price?5:4)}}function vi(n,i){if(n&1){let o=f();nt(0),s(1,"div",13)(2,"div",14)(3,"div",15)(4,"div"),p(5,"Departure:"),d(),s(6,"div"),C(7,mi,2,5)(8,ui,4,2),d(),s(9,"mat-icon",16),u("click",function(){let e=h(o).$index,a=J(0),r=l();return g(a.departure?r.onSave():r.toggleEditMode(e,"departure"))}),p(10),d()(),s(11,"div",15)(12,"div"),p(13,"Arrival:"),d(),s(14,"div"),C(15,hi,2,5)(16,gi,4,2),d(),s(17,"mat-icon",16),u("click",function(){let e=h(o).$index,a=J(0),r=l();return g(a.arrival?r.onSave():r.toggleEditMode(e,"arrival"))}),p(18),d()()(),s(19,"div",17)(20,"div",18)(21,"span"),p(22,"Price"),d(),s(23,"mat-icon",16),u("click",function(){let e=h(o).$index,a=J(0),r=l();return g(a.price?r.onSave():r.toggleEditMode(e,"price"))}),p(24),d()(),E(25,_i,6,2,"div",19,T),d()()}if(n&2){let o=i.$index,t=i.$index,e=l(),a=at(e.editMode()[o]());c(7),b(a.departure?8:7),c(3),D(" ",a.departure?"save":"edit"," "),c(5),b(a.arrival?16:15),c(3),D(" ",a.arrival?"save":"edit"," "),c(6),D(" ",a.price?"save":"edit"," "),c(),M(e.prices()[t])}}var Bt=(()=>{let i=class i{constructor(){this.ridesStore=_(P),this.rideId=ce.required(),this.stations=ce.required(),this.segments=ce.required(),this.dialog=_(Tt),this.prices=A(()=>this.segments().map(t=>Object.entries(t.price).map(([e,a])=>({type:e,value:a})))),this.editMode=A(()=>this.segments().map(()=>pe({departure:!1,arrival:!1,price:!1})))}openDialog(){this.dialog.open(Et,{data:{}}).afterClosed().subscribe(e=>{e&&this.ridesStore.deleteRide(this.rideId())})}toggleEditMode(t,e){this.editMode()[t].update(a=>K(U({},a),{[e]:!a[e]}))}onDepartureDateInput(t,e){this.segments()[t].time.departure.date=e}onDepartureTimeInput(t,e){this.segments()[t].time.departure.time=e}onArrivalDateInput(t,e){this.segments()[t].time.arrival.date=e}onArrivalTimeInput(t,e){this.segments()[t].time.arrival.time=e}onPriceInput(t,e,a,r){this.prices()[t][e].value=Number(r),this.segments()[t].price[a]=Number(r)}onSave(){this.editMode().forEach(t=>t.set({departure:!1,arrival:!1,price:!1})),this.ridesStore.updateRide(this.rideId())}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=S({type:i,selectors:[["app-ride-card"]],inputs:{rideId:[1,"rideId"],stations:[1,"stations"],segments:[1,"segments"]},standalone:!0,features:[I],decls:14,vars:1,consts:[["departureDate",""],["departureTime",""],["arrivalDate",""],["arrivalTime",""],["priceInput",""],[1,"card"],[1,"title-and-button"],[1,"title"],["mat-icon-button","",3,"click"],[1,"content"],[1,"stations"],[1,"station"],[1,"dates-and-prices"],[1,"row"],[1,"dates"],[1,"date-and-icon"],["color","primary",1,"icon",3,"click"],[1,"prices"],[1,"price-and-icon"],[1,"price"],["type","date",3,"input","value"],["type","time",3,"input","value"],[1,"price-type"],[1,"price-value"],["type","text",3,"value"],["type","text",3,"input","value"]],template:function(e,a){e&1&&(s(0,"div",5)(1,"div",6)(2,"div",7),p(3),d(),s(4,"button",8),u("click",function(){return a.openDialog()}),s(5,"mat-icon"),p(6,"delete"),d()()(),s(7,"div",9)(8,"div",10),E(9,pi,2,1,"div",11,T),d(),s(11,"div",12),E(12,vi,27,6,"div",13,T),d()()()),e&2&&(c(3),D("Ride ",a.rideId(),""),c(6),M(a.stations()),c(3),M(a.segments()))},dependencies:[st,ht,he],styles:[".card[_ngcontent-%COMP%]{padding:10px;border:1px solid gray;border-radius:5px}.title-and-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between;border-bottom:1px solid gray;margin-bottom:20px;padding-block:10px}.title[_ngcontent-%COMP%]{font-size:28px}.content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 2fr;column-gap:10px}.stations[_ngcontent-%COMP%]{padding-left:5px;background-color:#fff4e2;display:flex;flex-direction:column;justify-content:space-between;border-radius:4px}.row[_ngcontent-%COMP%]{display:grid;grid-template-columns:2fr 1fr;column-gap:20px}.dates[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:space-between}.prices[_ngcontent-%COMP%]{padding-block:50px}.price[_ngcontent-%COMP%]{display:flex;column-gap:10px}.date-and-icon[_ngcontent-%COMP%]{display:grid;grid-template-columns:max-content max-content 1fr;align-items:center;column-gap:10px}.price-and-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:space-between}.icon[_ngcontent-%COMP%]{justify-self:end}.icon[_ngcontent-%COMP%]:hover{cursor:pointer}"]});let n=i;return n})();function Ci(n,i){if(n&1){let o=f();s(0,"div",1)(1,"button",4),u("click",function(){h(o);let e=l();return g(e.accordion().openAll())}),p(2,"Expand All"),d(),s(3,"button",4),u("click",function(){h(o);let e=l();return g(e.accordion().closeAll())}),p(4,"Collapse All"),d()()}}function bi(n,i){n&1&&O(0,"app-spinner",2),n&2&&v("loadText","Loading the rides...")}function yi(n,i){if(n&1&&(s(0,"mat-expansion-panel")(1,"mat-expansion-panel-header")(2,"mat-panel-title"),p(3),d()(),O(4,"app-ride-card",5),d()),n&2){let o=i.$implicit,t=l(2);c(3),D(" Ride ",o.rideId," "),c(),v("rideId",o.rideId)("stations",t.store.stations())("segments",o.segments)}}function wi(n,i){if(n&1&&(s(0,"mat-accordion",3),E(1,yi,5,4,"mat-expansion-panel",null,T),d()),n&2){let o=l();c(),M(o.store.schedule())}}var Lt=(()=>{let i=class i{constructor(){this.store=_(P),this.accordion=We.required(oe)}};i.\u0275fac=function(e){return new(e||i)},i.\u0275cmp=S({type:i,selectors:[["app-ride-list"]],viewQuery:function(e,a){e&1&&Ze(a.accordion,oe,5),e&2&&Je()},standalone:!0,features:[I],decls:4,vars:2,consts:[[1,"list"],[1,"action-buttons"],[3,"loadText"],["multi",""],["mat-button","",3,"click"],[3,"rideId","stations","segments"]],template:function(e,a){e&1&&(s(0,"div",0),C(1,Ci,5,0,"div",1)(2,bi,1,1,"app-spinner",2)(3,wi,3,0,"mat-accordion",3),d()),e&2&&(c(),b(a.store.schedule().length?1:-1),c(),b(a.store.loading()?2:3))},dependencies:[Bt,Ht,oe,Ae,Pe,Nt,Q,It],styles:[".list[_ngcontent-%COMP%]{display:grid;row-gap:40px}.action-buttons[_ngcontent-%COMP%]{display:flex;justify-content:center}.action-buttons[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:200px}"]});let n=i;return n})();function Si(n,i){if(n&1){let o=f();s(0,"button",6),u("click",function(){h(o);let e=l();return g(e.showForm())}),p(1," Create Ride "),d()}}function Ii(n,i){if(n&1){let o=f();s(0,"app-ride-card-form",7),it("formVisibleChange",function(e){h(o);let a=l();return tt(a.formVisible,e)||(a.formVisible=e),g(e)}),d()}if(n&2){let o=l();et("formVisible",o.formVisible)}}var aa=(()=>{let i=class i{constructor(t,e){this.router=t,this.activatedRoute=e,this.routeId=null,this.stationsStore=_(xe),this.ridesStore=_(P),this.formVisible=pe(!1)}async ngOnInit(){let t=this.activatedRoute.snapshot.paramMap.get("id");if(!t||Number.isNaN(Number(t))){this.router.navigate([te.Admin,te.AdminRoutes]);return}this.routeId=Number(t),await this.stationsStore.getStations(),this.ridesStore.prepareStore(this.routeId)}onBackButtonClick(){this.router.navigate([te.Admin,te.AdminRoutes])}showForm(){this.formVisible.set(!0)}};i.\u0275fac=function(e){return new(e||i)(x(xt),x(gt))},i.\u0275cmp=S({type:i,selectors:[["app-rides"]],standalone:!0,features:[I],decls:10,vars:2,consts:[[1,"layout"],[1,"title-and-button"],["mat-mini-fab","",1,"btn",3,"click"],[1,"title"],["mat-flat-button","",1,"btn","btn-create-ride"],[3,"formVisible"],["mat-flat-button","",1,"btn","btn-create-ride",3,"click"],[3,"formVisibleChange","formVisible"]],template:function(e,a){e&1&&(s(0,"div",0)(1,"div",1)(2,"button",2),u("click",function(){return a.onBackButtonClick()}),s(3,"mat-icon"),p(4,"arrow_back"),d()(),s(5,"h3",3),p(6),d()(),C(7,Si,2,0,"button",4)(8,Ii,1,1,"app-ride-card-form",5),O(9,"app-ride-list"),d()),e&2&&(c(6),D("Route ",a.routeId,""),c(),b(a.formVisible()?8:7))},dependencies:[Q,ut,he,Lt,Ft],styles:[".layout[_ngcontent-%COMP%]{max-width:1200px;margin-inline:auto;padding:20px}.title-and-button[_ngcontent-%COMP%]{display:flex;align-items:center;gap:20px;margin-bottom:50px}.title[_ngcontent-%COMP%]{margin:0}.btn-create-ride[_ngcontent-%COMP%]{margin-bottom:20px}.btn[_ngcontent-%COMP%]{border-radius:4px}"]});let n=i;return n})();export{aa as RidesComponent};
