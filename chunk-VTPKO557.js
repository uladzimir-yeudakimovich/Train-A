import{a as ge,b as ue}from"./chunk-XEDZ3GRM.js";import{a as pe}from"./chunk-75FKSBTX.js";import{a as se,b as de}from"./chunk-IY4QER5N.js";import{a as me,b as ce,g as le}from"./chunk-D3ZEJMDG.js";import{c as L}from"./chunk-HTZT4UGI.js";import{a as R}from"./chunk-NDNJYYJX.js";import{a as z}from"./chunk-TF6AOZTO.js";import"./chunk-4T44NYJG.js";import{a as oe}from"./chunk-FPTRVRTR.js";import"./chunk-BNUCCXS7.js";import{b as ae,c as k}from"./chunk-F4STTNID.js";import{a as w}from"./chunk-EVOHVUKJ.js";import{a as ne}from"./chunk-F5E23MD5.js";import"./chunk-BOSFDDH7.js";import{A as te,C as re,E as ie,d as W,l as Y,n as C,p as H,q as J,u as K,v as Q,w as X,y as Z,z as ee}from"./chunk-PQ4C2WEQ.js";import"./chunk-YQJCNX7A.js";import{Ab as d,Ac as G,Cb as p,Fa as j,Ha as V,Hb as g,Kb as B,La as q,Lb as $,Mb as o,Nb as n,Ob as u,Sb as v,Xb as _,Zb as s,a as x,b as D,fb as c,gb as S,jc as l,ka as T,lb as U,lc as I,oa as F,rb as P,vc as O,ya as h,za as b,zc as A}from"./chunk-MTQVXK5S.js";function fe(e,i){e&1&&(o(0,"mat-error"),l(1,"Carriage name is required"),n())}function he(e,i){e&1&&(o(0,"mat-error"),l(1,"Invalid number of rows"),n())}function be(e,i){e&1&&(o(0,"mat-error"),l(1,"Number of left seats must be between 1 and 5"),n())}function Me(e,i){e&1&&(o(0,"mat-error"),l(1,"Number of right seats must be between 1 and 5"),n())}function xe(e,i){if(e&1&&u(0,"app-train-car",7),e&2){let m=s();p("carriage",m.prototypeCarriage())}}var N=(()=>{let i=class i{constructor(t,r){this.fb=t,this.destroyRef=r,this.carriage=null,this.addCarriage=new V,this.updateCarriage=new V,this.closeForm=new V,this.prototypeCarriage=P({name:"",rows:0,leftSeats:0,rightSeats:0,code:"",seats:[]}),this.carriageForm=this.fb.group({name:["",C.required],rows:[0,[C.required,C.min(1),C.max(50)]],leftSeats:[0,[C.required,C.min(1),C.max(5)]],rightSeats:[0,[C.required,C.min(1),C.max(5)]]})}ngOnInit(){this.carriage&&(this.carriageForm.patchValue(this.carriage),this.prototypeCarriage.set(this.carriage)),this.carriageForm.valueChanges.pipe(pe(this.destroyRef)).subscribe(t=>{this.carriageForm.valid&&this.prototypeCarriage.update(r=>D(x(x({},r),t),{seats:ae(x(x({},r),t))}))})}onSave(){if(this.carriageForm.valid&&!this.carriageForm.pristine){let t=x({code:this.carriage?this.carriage.code:""},this.carriageForm.value);this.carriage?this.updateCarriage.emit(t):this.addCarriage.emit(t)}}onReset(){this.carriageForm.reset()}onClose(){this.closeForm.emit()}isUpdateDisabled(){return this.carriageForm.pristine||!this.carriageForm.valid}};i.\u0275fac=function(r){return new(r||i)(S(re),S(j))},i.\u0275cmp=F({type:i,selectors:[["app-carriage-form"]],inputs:{carriage:"carriage"},outputs:{addCarriage:"addCarriage",updateCarriage:"updateCarriage",closeForm:"closeForm"},standalone:!0,features:[O],decls:31,vars:8,consts:[[1,"carriage-card"],[1,"carriage-form",3,"ngSubmit","formGroup"],["appearance","fill",1,"form-field-container"],["matInput","","formControlName","name","placeholder","Enter carriage name"],["matInput","","type","number","formControlName","rows","min","1","max","50","placeholder","Enter number of rows"],["matInput","","type","number","formControlName","leftSeats","min","1","max","5","placeholder","Enter number of left seats"],["matInput","","type","number","formControlName","rightSeats","min","1","max","5","placeholder","Enter number of right seats"],[3,"carriage"],[1,"form-actions"],["mat-flat-button","","type","button",1,"btn","cancel-button",3,"click"],["mat-flat-button","","type","button",1,"btn","reset-button",3,"click"],["mat-flat-button","","type","submit",1,"btn",3,"disabled"]],template:function(r,a){if(r&1&&(o(0,"mat-card",0)(1,"form",1),_("ngSubmit",function(){return a.onSave()}),o(2,"mat-form-field",2)(3,"mat-label"),l(4,"Carriage Name"),n(),u(5,"input",3),d(6,fe,2,0,"mat-error"),n(),o(7,"mat-form-field",2)(8,"mat-label"),l(9,"Rows"),n(),u(10,"input",4),d(11,he,2,0,"mat-error"),n(),o(12,"mat-form-field",2)(13,"mat-label"),l(14,"Left Seats"),n(),u(15,"input",5),d(16,be,2,0,"mat-error"),n(),o(17,"mat-form-field",2)(18,"mat-label"),l(19,"Right Seats"),n(),u(20,"input",6),d(21,Me,2,0,"mat-error"),n(),o(22,"div"),d(23,xe,1,1,"app-train-car",7),n(),o(24,"div",8)(25,"button",9),_("click",function(){return a.onClose()}),l(26," Cancel "),n(),o(27,"button",10),_("click",function(){return a.onReset()}),l(28," Reset "),n(),o(29,"button",11),l(30),n()()()()),r&2){let f,M,y,E;c(),p("formGroup",a.carriageForm),c(5),g((f=a.carriageForm.get("name"))!=null&&f.invalid&&((f=a.carriageForm.get("name"))!=null&&f.touched)?6:-1),c(5),g((M=a.carriageForm.get("rows"))!=null&&M.invalid&&((M=a.carriageForm.get("rows"))!=null&&M.touched)?11:-1),c(5),g((y=a.carriageForm.get("leftSeats"))!=null&&y.invalid&&((y=a.carriageForm.get("leftSeats"))!=null&&y.touched)?16:-1),c(5),g((E=a.carriageForm.get("rightSeats"))!=null&&E.invalid&&((E=a.carriageForm.get("rightSeats"))!=null&&E.touched)?21:-1),c(2),g(a.prototypeCarriage().seats.length?23:-1),c(6),p("disabled",a.isUpdateDisabled()),c(),I(" ",a.carriage?"Update":"Save"," ")}},dependencies:[le,de,se,me,ce,w,ie,K,Y,Q,H,J,te,ee,X,Z,L,R],styles:["[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]{padding:15px;background-color:#f2f2f2}[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]   .carriage-form[_ngcontent-%COMP%]{margin:0 auto}[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]   .carriage-form[_ngcontent-%COMP%]   .form-field-container[_ngcontent-%COMP%]:not(:nth-child(4)){position:relative;padding-right:1rem}[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]   .carriage-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{margin:1rem auto 0;display:flex;justify-content:space-around;max-width:500px}[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]   .carriage-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{min-width:25%}[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]   .carriage-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .cancel-button[_ngcontent-%COMP%]{background-color:#fad099}[_nghost-%COMP%]   .carriage-card[_ngcontent-%COMP%]   .carriage-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   .reset-button[_ngcontent-%COMP%]{background-color:#afafaf}"]});let e=i;return e})();var Fe=(e,i)=>i.code;function Se(e,i){if(e&1){let m=v();o(0,"h6",2),l(1),n(),o(2,"app-carriage-form",3),_("updateCarriage",function(r){h(m);let a=s(2);return b(a.updateCarriage(r))})("closeForm",function(){h(m);let r=s(2);return b(r.closeForm())}),n()}if(e&2){let m=s().$implicit;c(),I("Update ",m.name,""),c(),p("carriage",m)}}function Pe(e,i){if(e&1){let m=v();o(0,"button",4),_("click",function(){h(m);let r=s().$implicit,a=s();return b(a.toggleForm(r.code))}),o(1,"mat-icon",5),l(2,"edit_square"),n(),o(3,"label",6),l(4,"Update"),n()(),u(5,"app-train-car",7)}if(e&2){let m=s().$implicit;c(5),p("carriage",m)}}function ve(e,i){if(e&1&&(o(0,"mat-card",1),A(1,"removeWhitespace"),d(2,Se,3,2)(3,Pe,6,1),n()),e&2){let m=i.$implicit,t=s();p("id","car"+G(1,2,m.name)),c(2),g(t.selectedCarriageCode()===m.code?2:3)}}var _e=(()=>{let i=class i{constructor(t,r){this.activatedRoute=t,this.renderer=r,this.carriages=q.required(),this.selectedCarriageCode=P(null),this.store=T(k)}toggleForm(t){let r=this.selectedCarriageCode();this.selectedCarriageCode.set(r===t?null:t)}updateCarriage(t){this.store.updateCarriage(t),this.selectedCarriageCode.set(null)}closeForm(){this.selectedCarriageCode.set(null)}ngAfterViewInit(){let{fragment:t}=this.activatedRoute.snapshot;t&&setTimeout(()=>this.scrollToCarriage(t),1e3)}scrollToCarriage(t){let r=ge(t),M=this.renderer.selectRootElement(`#car${r}`,!0).getBoundingClientRect().top+window.scrollY-100;window.scrollTo({top:M,behavior:"smooth"})}};i.\u0275fac=function(r){return new(r||i)(S(W),S(U))},i.\u0275cmp=F({type:i,selectors:[["app-carriage-list"]],inputs:{carriages:[1,"carriages"]},standalone:!0,features:[O],decls:3,vars:0,consts:[[1,"list"],[1,"card",3,"id"],[1,"text-center"],[3,"updateCarriage","closeForm","carriage"],["mat-raised-button","",1,"update-button",3,"click"],["id","update","aria-hidden","false","aria-label","Update route"],["for","edit"],[3,"carriage"]],template:function(r,a){r&1&&(o(0,"mat-list",0),B(1,ve,4,4,"mat-card",1,Fe),n()),r&2&&(c(),$(a.carriages()))},dependencies:[ne,w,L,N,R,z,ue],styles:["[_nghost-%COMP%]{display:block;width:100%}[_nghost-%COMP%]   .list[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-between;gap:2rem}[_nghost-%COMP%]   .list[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]{padding:15px;background-color:#f2f2f2;width:100%}[_nghost-%COMP%]   .list[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .text-center[_ngcontent-%COMP%]{text-align:center}[_nghost-%COMP%]   .list[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .update-button[_ngcontent-%COMP%]{position:absolute;right:1rem}[_nghost-%COMP%]   .list[_ngcontent-%COMP%]   .card[_ngcontent-%COMP%]   .update-button[_ngcontent-%COMP%]   .mat-icon[_ngcontent-%COMP%]{margin:0}"]});let e=i;return e})();function Oe(e,i){e&1&&u(0,"app-spinner",0),e&2&&p("loadText","Loading the carriages...")}function we(e,i){if(e&1){let m=v();o(0,"button",4),_("click",function(){h(m);let r=s(2);return b(r.isShowForm())}),l(1," Create new carriage "),n()}}function ye(e,i){if(e&1){let m=v();o(0,"app-carriage-form",5),_("addCarriage",function(r){h(m);let a=s(2);return b(a.addCarriage(r))})("closeForm",function(){h(m);let r=s(2);return b(r.isShowForm())}),n()}}function Ee(e,i){if(e&1&&(o(0,"div",1),d(1,we,2,0,"button",2)(2,ye,1,0,"app-carriage-form"),n(),u(3,"app-carriage-list",3)),e&2){let m=s();c(),g(m.formVisible()?2:1),c(2),p("carriages",m.carriages())}}var _t=(()=>{let i=class i{constructor(){this.formVisible=P(!1),this.carriageStore=T(k)}ngOnInit(){this.carriageStore.getCarriages(),this.carriages=this.carriageStore.carriagesEntities}isShowForm(){this.formVisible.update(t=>!t)}addCarriage(t){this.formVisible.set(!1),this.carriageStore.addCarriage(t)}};i.\u0275fac=function(r){return new(r||i)},i.\u0275cmp=F({type:i,selectors:[["app-carriages"]],standalone:!0,features:[O],decls:2,vars:1,consts:[[3,"loadText"],[1,"carriage-form"],["mat-flat-button","",1,"button-center"],[3,"carriages"],["mat-flat-button","",1,"button-center",3,"click"],[3,"addCarriage","closeForm"]],template:function(r,a){r&1&&d(0,Oe,1,1,"app-spinner",0)(1,Ee,4,2),r&2&&g(a.carriages().length?1:0)},dependencies:[w,N,_e,oe],styles:["[_nghost-%COMP%]{display:flex;flex-wrap:wrap;justify-content:center;width:85%;margin:0 auto}[_nghost-%COMP%]   .carriage-form[_ngcontent-%COMP%]{margin:1rem}[_nghost-%COMP%]   .carriage-form[_ngcontent-%COMP%]   .button-center[_ngcontent-%COMP%]{margin:0 auto}"]});let e=i;return e})();export{_t as CarriagesComponent};
